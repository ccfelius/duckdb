# name: benchmark/realnest/7_count_map_keys.benchmark
# description: Count map keys and aggregate them
# group: [realnest]

name count_map_keys
group real_nest

require json

require httpfs

load benchmark/realnest/load.sql

run
SELECT keys, count(*) mentions FROM
    (SELECT UNNEST(map_keys(tags)) AS keys FROM daylight)
    GROUP BY keys
    ORDER BY mentions DESC
    LIMIT 20;
