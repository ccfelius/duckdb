# name: benchmark/realnest/07_select_text.benchmark
# description: Creates a list of unnested texts, counts texts string's length and returns a number of unique values
# group: [realnest]

name list_operations_on_strings
group real_nest

require json

require httpfs

cache real_nest.duckdb

load benchmark/realnest/load.sql

run
SELECT list_unique(list_transform(lt, s -> length(s))) 
FROM (SELECT list(text) AS lt FROM (SELECT bm.text FROM (SELECT UNNEST(back_matter) AS bm FROM cord)));