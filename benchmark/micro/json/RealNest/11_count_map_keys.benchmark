# name: benchmark/micro/json/RealNest/10_count_map_keys.benchmark
# description: Count map keys and aggregate them
# group: [real_nest]

name count_map_keys
group real_nest

require json

require httpfs

load benchmark/micro/json/RealNest/load.sql

run
select keys, count(*) mentions from
      (select unnest(map_keys(tags)) as keys from daylight)
  group by keys
  order by mentions
  desc limit 20;