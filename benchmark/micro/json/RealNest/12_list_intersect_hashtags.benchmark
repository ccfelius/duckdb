# name: benchmark/micro/json/RealNest/12_list_intersect_hashtags.benchmark
# description: Count map keys and aggregate them
# group: [RealNest]

name count_map_keys
group real_nest

require json

require httpfs

load benchmark/micro/json/RealNest/load.sql

run
SELECT keys, count(*) mentions FROM
      (select unnest(map_keys(tags)) AS keys from daylight)
  group by keys
  order by mentions
  desc limit 20;