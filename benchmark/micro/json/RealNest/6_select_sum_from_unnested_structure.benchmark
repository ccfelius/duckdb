# name: benchmark/micro/json/RealNest/6_select_sum_from_unnested_structure.benchmark
# description: select sum from unnested structure Muon
# group: [RealNest]

name select_sum_from_unnested_structure
group real_nest

require json

require httpfs

load benchmark/micro/json/RealNest/load.sql

run
SELECT charge, sum(pt), sum(eta), sum(phi), sum(mass)
FROM (
    SELECT UNNEST(Muon, recursive:=true) AS unnested_muon
    FROM Run2012B_SingleMu
    )
GROUP BY charge
;

#REPLACE a query