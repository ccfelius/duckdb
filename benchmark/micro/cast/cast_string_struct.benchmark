# name: benchmark/micro/cast/cast_string_struct.benchmark
# description: Cast string values to struct
# group: [cast]

name Cast VARCHAR -> STRUCT
group cast

load
CREATE TABLE structs AS SELECT {'key_A': i, 'key_B': i + 1, 'key_C': i + 2}::VARCHAR v FROM range(0, 10000000) tbl(i);

run
SELECT MIN(CAST(v AS STRUCT(key_A VARCHAR, key_B VARCHAR, key_C VARCHAR))) FROM structs;

result I
{'key_A': 0, 'key_B': 1, 'key_C': 2}