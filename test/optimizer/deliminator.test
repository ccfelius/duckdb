# name: test/optimizer/deliminator.test
# description: Test the Deliminator optimizer
# group: [optimizer]

require tpch

statement ok


statement ok
CREATE TABLE integers(i INTEGER, j integer)

statement ok
INSERT INTO integers VALUES  (NULL,1)

query II
SELECT i, (select SUM(i) is not null from integers where j = i1.j) FROM integers i1 ORDER BY 1;
----
NULL	False

query II
SELECT i, (select SUM(i) AND false from integers where j = i1.j) FROM integers i1 ORDER BY 1;
----
NULL	False

query II
SELECT i, (select SUM(i) OR true from integers where j = i1.j) FROM integers i1 ORDER BY 1;
----
NULL	True

query II
SELECT i, (select SUM(i) IS DISTINCT FROM NULL  from integers where j = i1.j) FROM integers i1 ORDER BY 1;
----
NULL	False

query II
SELECT i, (select SUM(i) IS NOT DISTINCT FROM NULL  from integers where j = i1.j) FROM integers i1 ORDER BY 1;
----
NULL	TRUE

query II
SELECT i, (select CONCAT(SUM(i), 'hello') from integers where j = i1.j) FROM integers i1 ORDER BY 1;
----
NULL	hello

query II
SELECT i, (select [SUM(i)] from integers where j = i1.j) FROM integers i1 ORDER BY 1;
----
NULL	[NULL]

query II
SELECT i, (select {'a': SUM(i)} from integers where j = i1.j) FROM integers i1 ORDER BY 1;
----
NULL	{'a': NULL}

statement ok
INSERT INTO integers VALUES  (1,2)

query II
SELECT i, (select sum(i) from integers where j is null and j = i1.j) FROM integers i1 ORDER BY 1;
----
NULL	NULL
1	NULL