# name: test/optimizer/unused_columns/distinct_on_projection_pushdown.test
# description: Test DISTINCT ON ORDER BY
# group: [distinct]

statement ok
PRAGMA enable_verification

statement ok
create table t0 as select random()*1000 col0, random()*100000 col1, random()*100000 col2, '1' col3, '2' col4, '3' col5 from range(1000000);

statement ok
PRAGMA explain_output = OPTIMIZED_ONLY;

query II
EXPLAIN SELECT col0
FROM 
(
    SELECT 
    DISTINCT ON (floor(col0))	e
    *
    FROM t0
    ORDER by col0 DESC
)
----
logical_opt	<!REGEX>:.*col[1-5].*
