# name: test/optimizer/expression_rewriter/functions_that_error_are_not_reordered.test
# description: Functions can error
# group: [expression_rewriter]

statement ok
create table t1 as from range(-5000, 5000, 1) t1(a);

query I
select count(*) from t1 where case when a >= 0 then true When a > 5 then false when a > 10 then true when a < 0 then false when a > 15 then true else false END and sqrt(a) >= 0;
----
5000

statement ok
create table t2 as
select list_reduce([floor((random() * 2))::INT::VARCHAR for t, i in range(floor((random() * 20))::INT + 1)], (x, y) -> concat(x, y)) a,
       list_reduce([floor((random() * 2))::INT::VARCHAR for t, i in range(floor((random() * 20))::INT + 1)], (x, y) -> concat(x, y)) b from range(10000)
;

statement ok
select * from t2 where len(a) = len(b) and ((xor(a::BITSTRING, b::BITSTRING))::VARCHAR)[0] = '0';

