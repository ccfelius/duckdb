# name: test/optimizer/joins/wide_build_skinny_probe.test
# description: If the build side is wide, and the probe side is skinny, the children of the hash join should flip
# group: [joins]

statement ok
create table skinny as select range a, range b, range c from range(10000);


statement ok
create table wide as select 
	range pk,
	(range::VARCHAR || '1111') a, 
	(range::VARCHAR || '2222') b, 
	(range::VARCHAR || '3333') c,
	(range::VARCHAR || '4444') d,
	(range::VARCHAR || '5555') e,
	(range::VARCHAR || '6666') f,
	(range::VARCHAR || '7777') g,
	(range::VARCHAR || '8888') h,
	(range::VARCHAR || '9999') i,
	(range::VARCHAR || '0000') j,
	(range::VARCHAR || '0011') k,
	(range::VARCHAR || '0022') l,
	(range::VARCHAR || '0033') m,
	(range::VARCHAR || '0044') n from range(8000);
	

statement ok
set explain_output = OPTIMIZED_ONLY;

# wide should be the probe side, skinny should be on the build side
query II
explain select * from wide w, skinny s where w.pk=s.a;
----
logical_opt	<REGEX>:.*wide.*skinny.*
