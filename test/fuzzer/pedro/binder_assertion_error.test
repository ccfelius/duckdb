# name: test/fuzzer/pedro/binder_assertion_error.test
# description: Issue #4978 (16): Binder assertion error
# group: [pedro]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE t0 (c0 INT);

query I
SELECT (SELECT 2) c0 WHERE (SELECT (SELECT (SELECT c0)));
----
2

query I
SELECT (SELECT 0) c0 WHERE (SELECT c0);
----

statement error
select (select 42) as a, (select a);
----
Serialization Error: Cannot copy BoundSubqueryExpression

# The last a should resolve to 1 from the (select 1) a
# The b should resolve to 3
query I
select (select 1) a where (select (select 3) b where (select b) > (select a));
----
1

# the b alias resolves to the where alias binder in the subquery
# the a alias resolves to the where alias binder from the select clause.
query I
select (select 5) a where (select (select 3) b where (select b) > (select a));
----

# Similar to the above test case but its a positive case
query II
select (select 5) a, (select 7) c where (select (select 3) b where (select a) > (select b) and (select c) > (select a));
----
5	7
