# name: test/issues/general/test_5614.test
# description: Issue 5614: 
# group: [general]

statement ok
create table gutenburg as select * from read_csv_auto('/Users/tomebergen/duckdb/gutenburg.csv');

statement ok
explain select 
row_number() over () as line_number, 
column0 as text, 
length(coalesce(column0, '')) as text_length 
from 
gutenburg
where 'LORD' in (select * from unnest(str_split(column0, ' ')));

mode skip

statement ok
CREATE or replace TABLE brands (category VARCHAR, brand_name VARCHAR);

statement ok
INSERT INTO brands (category, brand_name) VALUES ('chocolates', '5-star'), (Null, 'diary milk'), (Null, 'perk'), (Null, 'eclair'), ('Biscuits', 'britannia'), (Null, 'good day'), (Null, 'boost');

statement error
with cte as (
select 
  *, 
  row_number() over () as t,
  count(category) over (order by t) as tmp
from brands
)
select
  max(category) over (partition by tmp) as category,
  brand_name
from cte;
----
Binder Error
