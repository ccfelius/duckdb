# name: test/sql/export/export_indexes.test
# description: Test export of macro's
# group: [export]

statement ok
BEGIN TRANSACTION

statement ok
CREATE SCHEMA my_schema

# scalar macro
statement ok
CREATE MACRO my_schema.elaborate_macro(x, y := 7) AS x + y;

statement ok
CREATE TABLE my_schema.tbl (x integer, y varchar);

# Index that depends on the 'elaborate_macro' macro function
statement ok
CREATE INDEX my_index on my_schema.tbl (my_schema.elaborate_macro(tbl.x));

statement ok
EXPORT DATABASE '__TEST_DIR__/export_macros' (FORMAT CSV);

statement ok
ROLLBACK

statement ok
IMPORT DATABASE '__TEST_DIR__/export_macros'

query T
SELECT my_schema.elaborate_macro(28, y := 5)
----
33
