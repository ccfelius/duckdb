# name: test/sql/parser/digit_separators.test
# group: [parser]

query I
SELECT 1__2
----
12

query I
SELECT 1_000_000
----
1000000

query I
SELECT '1_____000___000_000'::INT
----
1_000_000_000

# Cant start with an underscore
statement error
SELECT _1__2 == 12

# Cant end with an underscore
statement error
SELECT 1__2_ == 12

# Decimals
query I
SELECT 1__2.1__2
----
12.12

query I
SELECT 12.1__2
----
12.12

query I
SELECT 1_2.12
----
12.12

# Cant start with an underscore
statement error
SELECT _12.12 == 12.12

statement error
SELECT 12._12 == 12.12

# Cant end with an underscore
statement error
SELECT 12_.12 == 12.12

statement error
SELECT 12.12_ == 12.12

# Floats
query I
SELECT '1___2.1___2'::FLOAT
----
12.12

query I
SELECT '12.1___2'::FLOAT
----
12.12

query I
SELECT '1___2.12'::FLOAT
----
12.12

query I
SELECT '12.1_2e2'::FLOAT
----
12.12e2

# Cant start with an underscore
statement error
SELECT '_12.12'::FLOAT == 12.12

statement error
SELECT '12._12'::FLOAT == 12.12

statement error
SELECT '12._12e2'::FLOAT == 12.12e2

# Cant end with an underscore
statement error
SELECT '12_.12'::FLOAT == 12.12

statement error
SELECT '12.12_'::FLOAT == 12.12

statement error
SELECT '12.12_e2'::FLOAT == 12.12e2

# Large reals > 19 digits
query I
SELECT 1_000_000_000_000_000_000_000::DOUBLE
----
1e+21

query I
SELECT .000_000_000_000_000_000_000_123::DOUBLE
----
123e-23

query I
SELECT 1_000_000_000_000_000_000_000.5::DOUBLE
----
1000000000000000000000.5

query I
SELECT 1_000_000_000.000_000_000_5::DOUBLE
----
1000000000.0000000005

# Cant start with an underscore
statement error
SELECT _1_000_000_000_000_000_000_000::DOUBLE == 1e+21

statement error
SELECT ._000_000_000_000_000_000_000_123::DOUBLE == 123e-23

# Cant end with an underscore
statement error
SELECT 1_000_000_000_000_000_000_000_::DOUBLE == 1e+21

statement error
SELECT .000_000_000_000_000_000_000_123_::DOUBLE == 123e-23