# name: test/sql/parser/generated_column_on_create.test
# description: Create a table with a generated column
# group: [parser]

statement error
CREATE TABLE unit (
    total_profit INTEGER GENERATED ALWAYS AS(price * not_in_table) VIRTUAL,
    price INTEGER,
    amount_sold INTEGER,
);

statement ok
CREATE TABLE unit (
    total_profit INTEGER GENERATED ALWAYS AS(price * amount_sold) VIRTUAL,
    price INTEGER,
    amount_sold INTEGER,
);

statement ok
INSERT INTO unit VALUES (5,4)

query I
SELECT total_profit FROM unit;
----
20

# Delete the generated column
statement ok
ALTER TABLE unit DROP COLUMN total_profit;

# We can now no longer select it
statement error
SELECT total_profit FROM unit;
