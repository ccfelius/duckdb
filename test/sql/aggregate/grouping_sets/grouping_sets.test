# name: test/sql/aggregate/grouping_sets/grouping_sets.test
# description: Test basic grouping sets
# group: [grouping_sets]

statement ok
PRAGMA enable_verification

statement ok
create table nurses (
	id integer,
	full_name varchar,
	medical_license varchar,   -- LVN, RN, etc.
	radio_license varchar      -- Technician, General, Amateur Extra
	)
	;

statement ok
insert into nurses
		(id, full_name, medical_license, radio_license)
	values
		(201, 'Thomas Leonard Vicente', 'LVN', 'Technician'),
		(202, 'Tamara Lolita VanZant', 'LVN', 'Technician'),
		(341, 'Georgeann Linda Vente', 'LVN', 'General'),
		(471, 'Andrea Renee Nouveau', 'RN', 'Amateur Extra')
		;

# empty grouping
query I
select count(*) from nurses group by ();
----
4

# multiple grouping sets
query III
select count(*), medical_license, radio_license
	from nurses
	group by grouping sets (medical_license, radio_license)
	order by 1, 2, 3;
----
1	NULL	General
1	NULL	Amateur Extra
1	RN	NULL
2	NULL	Technician
3	LVN	NULL

# multiple disjoint grouping sets
query III
select count(*), medical_license, radio_license
	from nurses
	group by grouping sets (medical_license), grouping sets(radio_license)
	order by 1, 2, 3;
----
1	RN	Amateur Extra
1	LVN	General
2	LVN	Technician

# now with some null values
statement ok
insert into nurses
    (id, full_name, medical_license, radio_license)
  values
    (101, 'Lily Vine', 'LVN', null),
    (102, 'Larry Vancouver', 'LVN', null),
    (172, 'Rhonda Nova', 'RN', null)
    ;

query I
select count(*) from nurses group by ();
----
7

# multiple grouping sets
query III
select count(*), medical_license, radio_license
	from nurses
	group by grouping sets (medical_license, radio_license)
	order by 1, 2, 3;
----
1	NULL	Amateur Extra
1	NULL	General
2	RN	NULL
2	NULL	Technician
3	NULL	NULL
5	LVN	NULL

# multiple disjoint grouping sets
query III
select count(*), medical_license, radio_license
	from nurses
	group by grouping sets (medical_license), grouping sets(radio_license)
	order by 1, 2, 3;
----
1	LVN	General
1	RN	NULL
1	RN	Amateur Extra
2	LVN	NULL
2	LVN	Technician

