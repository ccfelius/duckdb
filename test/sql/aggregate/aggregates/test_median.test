# name: test/sql/aggregate/aggregates/test_median.test
# description: Test MEDIAN operator
# group: [aggregates]

statement ok
CREATE TABLE doubles(d double, g integer);

statement ok
INSERT INTO doubles VALUES (1, 1), (2, 1), (3, 1), (NULL, 1), (NULL, 1), (NULL, 1), (5, 2), (6, 2), (7, 2), (8, 2)

query R
SELECT median(d) FROM doubles where g = 1;
----
2

query IR
SELECT g, median(d) FROM doubles group by g order by g;
----
1
2
2
7

query R
SELECT median(range::double) FROM range(100000);
----
50000

query R
SELECT median(range::tinyint) FROM range(100);
----
50

query R
SELECT median(range::smallint) FROM range(10000);
----
5000

query R
SELECT median(range::integer) FROM range(100000);
----
50000

query R
SELECT median(range::bigint) FROM range(100000);
----
50000

query R
SELECT median(range::hugeint) FROM range(100000);
----
50000