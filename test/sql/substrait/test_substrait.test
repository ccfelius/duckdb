# name: test/sql/substrait/test_substrait.test
# description: Test get_substrait and from_substrait basic functionality
# group: [substrait]

require substrait

require tpch

statement ok
CALL dbgen(sf=0.01);

query I
CALL get_substrait('select count(l_shipdate) from lineitem')
----
\x12\x0E\x1A\x0C\x1A\x0Acount_star\x1A2\x0A0:.\x12$""\x12\x1A\x0A\x18\x0A\x02\x0A\x00"\x06\x0A\x04\x0A\x02\x08\x0A:\x0A\x0A\x08lineitem\x1A\x00"\x02\x0A\x00\x1A\x06\x12\x04\x0A\x02\x12\x00


query I
CALL from_substrait('\x12\x0E\x1A\x0C\x1A\x0Acount_star\x1A2\x0A0:.\x12$""\x12\x1A\x0A\x18\x0A\x02\x0A\x00"\x06\x0A\x04\x0A\x02\x08\x0A:\x0A\x0A\x08lineitem\x1A\x00"\x02\x0A\x00\x1A\x06\x12\x04\x0A\x02\x12\x00'::BLOB)
----
60175