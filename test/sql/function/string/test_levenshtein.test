# name: test/sql/function/string/test_levenshtein.test
# description: Test levenshtein function
# group: [string]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE strings(s VARCHAR)

statement ok
INSERT INTO strings VALUES ('hello'), ('hallo'), ('aloha'), ('fello'), ('fellow'), ('ducks')

# normal queries
query I
SELECT levenshtein('hallo', 'hallo')
----
0

query I
SELECT levenshtein('hallo', 'hello')
----
1

query I
SELECT levenshtein('hello', 'hallo')
----
1

query I
SELECT levenshtein('lawn', 'flaw')
----
2

query I
SELECT levenshtein('flaw', 'lawn')
----
2

query I
SELECT levenshtein('kitten', 'sitting')
----
3

query I
SELECT levenshtein('sitting', 'kitten')
----
3

query I
SELECT levenshtein('hallo', 'hoi')
----
4

query I
SELECT levenshtein('hoi', 'hallo')
----
4

query I
SELECT levenshtein(NULL, 'hoi')
----
NULL

query I
SELECT levenshtein('hi', NULL)
----
NULL

query I
SELECT levenshtein(s, 'hallo') FROM strings ORDER BY s
----
4
0
1
2
3
5

query I
SELECT levenshtein('hallo', s) FROM strings ORDER BY s
----
4
0
1
2
3
5

query I
SELECT levenshtein(NULL, s) FROM strings 
----
NULL
NULL
NULL
NULL
NULL

query I
SELECT levenshtein(NULL, s) FROM strings 
----
NULL
NULL
NULL
NULL
NULL

# incorrect usage
statement error
SELECT mismatches('', 'hallo') 

statement error
SELECT mismatches('hi', '') 

statement error
SELECT mismatches('', NULL) 

statement error
SELECT mismatches(NULL, '') 

statement error
SELECT mismatches('', s) FROM strings

statement error
SELECT mismatches(s, '')  FROM strings


statement ok
DROP TABLE strings

statement ok
CREATE TABLE strings(s VARCHAR)

statement ok
INSERT INTO strings VALUES (NULL)

statement error
SELECT mismatches('', s)  FROM strings

statement error
SELECT mismatches(s, '')  FROM strings



statement ok
DROP TABLE strings

statement ok
CREATE TABLE strings(s VARCHAR)

statement ok
INSERT INTO strings VALUES ('')

statement error
SELECT mismatches(NULL, s)  FROM strings

statement error
SELECT mismatches(s, NULL)  FROM strings
