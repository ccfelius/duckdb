# name: test/sql/function/string/test_damerau_levenshtein.test
# description: Test damerau_levenshtein function
# group: [string]

statement ok
PRAGMA enable_verification


# normal queries
query I
SELECT damerau_levenshtein('out', 'out')
----
0

query I
SELECT damerau_levenshtein('three', 'there')
----
1

query I
SELECT damerau_levenshtein('potion', 'option')
----
1

query I
SELECT damerau_levenshtein('letter', 'lettre')
----
1

query I
SELECT damerau_levenshtein('three', 'there')
----
1

query I
SELECT damerau_levenshtein('out', 'to')
----
2

query I
SELECT damerau_levenshtein('to', 'out')
----
2

query I
SELECT damerau_levenshtein('laos', 'also')
----
2

query I
SELECT damerau_levenshtein('tomato', 'otamot')
----
3

query I
SELECT damerau_levenshtein('abcdefg', 'bacedgf')
----
3

query I
SELECT damerau_levenshtein('abcdefg', 'bacedgf')
----
3

query I
SELECT damerau_levenshtein('abcdefghi', 'bzacdefig')
----
4

query I
SELECT damerau_levenshtein('bzacdefig', 'abcdefghi')
----
4

query I
SELECT damerau_levenshtein('at', 'tarokk')
----
5

query I
SELECT damerau_levenshtein('tarokk', 'at')
----
5

query I
SELECT damerau_levenshtein('organ', 'no')
----
4

query I
SELECT damerau_levenshtein('trips', 'strip')
----
2

query I
SELECT damerau_levenshtein('cat', 'cats')
----
1

query I
SELECT damerau_levenshtein('rat', 'brat')
----
1

query I
SELECT damerau_levenshtein('', 'great')
----
5

query I
SELECT damerau_levenshtein('great', '')
----
5

query I
SELECT damerau_levenshtein('', '')
----
0

query I
SELECT damerau_levenshtein(NULL, 'drive')
----
NULL

query I
SELECT damerau_levenshtein('drive', NULL)
----
NULL

query I
SELECT damerau_levenshtein(NULL, NULL)
----
NULL

query I
SELECT damerau_levenshtein('', NULL)
----
NULL

query I
SELECT damerau_levenshtein(NULL, '')
----
NULL


statement error
SELECT damerau_levenshtein('one', 'two', 'three')

statement error
SELECT damerau_levenshtein('one')

statement error
SELECT damerau_levenshtein()


statement ok
CREATE TABLE strings(s VARCHAR)

statement ok
INSERT INTO strings VALUES ('here'), ('heres'), ('there'), ('three'), ('threes')

query I
SELECT damerau_levenshtein(s, 'theres') FROM strings ORDER BY s
----
2
1
1
2
1

query I
SELECT damerau_levenshtein('herse', s) FROM strings ORDER BY s
----
1
1
2
3
3

query I
SELECT damerau_levenshtein(NULL, s) FROM strings
----
NULL
NULL
NULL
NULL
NULL

query I
SELECT damerau_levenshtein(NULL, s) FROM strings
----
NULL
NULL
NULL
NULL
NULL

query I
SELECT damerau_levenshtein('', s) FROM strings ORDER BY s
----
4
5
5
5
6

query I
SELECT damerau_levenshtein(s, '') FROM strings ORDER BY s
----
4
5
5
5
6

