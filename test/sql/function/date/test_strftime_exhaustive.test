# name: test/sql/function/date/test_strftime_exhausted.test
# description: Test all strftime % codes with the date type
# group: [date]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE dates(d DATE);
INSERT INTO dates VALUES ('1992-01-01'), ('1993-03-20'), ('2020-08-09'), ('2020-08-10'), (NULL);

# %a: Abbreviated weekday name
query I
SELECT strftime('%a', d) FROM dates ORDER BY d;
----
NULL
Wed
Sat
Sun
Mon

# %A: Full weekday name
query I
SELECT strftime('%A', d) FROM dates ORDER BY d;
----
NULL
Wednesday
Saturday
Sunday
Monday

# %w - Weekday as a decimal number.
query I
SELECT strftime('%w', d) FROM dates ORDER BY d;
----
NULL
3
6
0
1

# %d - Day of the month as a zero-padded decimal.
query I
SELECT strftime('%d', d) FROM dates ORDER BY d;
----
NULL
01
20
09
10

# %-d - Day of the month as a decimal number.
query I
SELECT strftime('%-d', d) FROM dates ORDER BY d;
----
NULL
1
20
9
10

# %b - Abbreviated month name.
query I
SELECT strftime('%b', d) FROM dates ORDER BY d;
----
NULL
Jan
Mar
Aug
Aug

# %h - alias for %b
query I
SELECT strftime('%h', d) FROM dates ORDER BY d;
----
NULL
Jan
Mar
Aug
Aug

# %B - Full month name
query I
SELECT strftime('%B', d) FROM dates ORDER BY d;
----
NULL
January
March
August
August

# %m - Month as a zero-padded decimal number
query I
SELECT strftime('%m', d) FROM dates ORDER BY d;
----
NULL
01
03
08
08

# %-m - Month as a decimal number. (1, 2, ..., 12)
query I
SELECT strftime('%-m', d) FROM dates ORDER BY d;
----
NULL
1
3
8
8

# %y - Year without century as a zero-padded decimal number.
query I
SELECT strftime('%y', d) FROM dates ORDER BY d;
----
NULL
92
93
20
20

# %-y - Year without century as a decimal number.
query I
SELECT strftime('%-y', d) FROM dates ORDER BY d;
----
NULL
92
93
20
20

query I
SELECT strftime('%-y', DATE '2001-01-01')
----
1

# %Y - Year with century as a decimal number.
query I
SELECT strftime('%Y', d) FROM dates ORDER BY d;
----
NULL
1992
1993
2020
2020

# %H - Hour (24-hour clock) as a zero-padded decimal number.
query I
SELECT strftime('%H', d) FROM dates ORDER BY d;
----
NULL
00
00
00
00

# %-H - Hour (24-hour clock) as a decimal number. (0, 1, ..., 23)
query I
SELECT strftime('%-H', d) FROM dates ORDER BY d;
----
NULL
0
0
0
0

# %I - Hour (12-hour clock) as a zero-padded decimal number.
query I
SELECT strftime('%I', d) FROM dates ORDER BY d;
----
NULL
12
12
12
12

# %-I - Hour (12-hour clock) as a decimal number. (1, 2, ... 12)
query I
SELECT strftime('%-I', d) FROM dates ORDER BY d;
----
NULL
12
12
12
12

# %p - Locale’s AM or PM.
query I
SELECT strftime('%p', d) FROM dates ORDER BY d;
----
NULL
AM
AM
AM
AM

# %M - Minute as a zero-padded decimal number.
query I
SELECT strftime('%M', d) FROM dates ORDER BY d;
----
NULL
00
00
00
00

# %-M - Minute as a decimal number. (0, 1, ..., 59)
query I
SELECT strftime('%-M', d) FROM dates ORDER BY d;
----
NULL
0
0
0
0

# %S - Second as a zero-padded decimal number.
query I
SELECT strftime('%S', d) FROM dates ORDER BY d;
----
NULL
00
00
00
00

# %-S - Second as a decimal number. (0, 1, ..., 59)
query I
SELECT strftime('%-S', d) FROM dates ORDER BY d;
----
NULL
0
0
0
0

# %f - Microsecond as a decimal number, zero-padded on the left.
query I
SELECT strftime('%f', d) FROM dates ORDER BY d;
----
NULL
000000
000000
000000
000000

# %z - UTC offset in the form +HHMM or -HHMM.
query I
SELECT strftime('%z', d) FROM dates ORDER BY d;
----
NULL
(empty)
(empty)
(empty)
(empty)

# %Z - Time zone name.
query I
SELECT strftime('%Z', d) FROM dates ORDER BY d;
----
NULL
(empty)
(empty)
(empty)
(empty)

# %j - Day of the year as a zero-padded decimal number.
query I
SELECT strftime('%j', d) FROM dates ORDER BY d;
----
NULL
001
079
222
223

# %-j - Day of the year as a decimal number. (1, 2, ..., 366)
query I
SELECT strftime('%-j', d) FROM dates ORDER BY d;
----
NULL
1
79
222
223

# %U - Week number of the year (Sunday as the first day of the week).
query I
SELECT strftime('%U', d) FROM dates ORDER BY d;
----
NULL
00
11
32
32

# %W - Week number of the year (Monday as the first day of the week).
query I
SELECT strftime('%W', d) FROM dates ORDER BY d;
----
NULL
00
11
31
32

# %c - Locale’s appropriate date and time representation.
query I
SELECT strftime('%c', d) FROM dates ORDER BY d;
----
NULL
1992-01-01 00:00:00
1993-03-20 00:00:00
2020-08-09 00:00:00
2020-08-10 00:00:00

query I
SELECT strftime('XX%cXX', d) FROM dates ORDER BY d;
----
NULL
XX1992-01-01 00:00:00XX
XX1993-03-20 00:00:00XX
XX2020-08-09 00:00:00XX
XX2020-08-10 00:00:00XX

# %x - Locale’s appropriate date representation.
query I
SELECT strftime('%x', d) FROM dates ORDER BY d;
----
NULL
1992-01-01
1993-03-20
2020-08-09
2020-08-10

# X - Locale’s appropriate time representation.
query I
SELECT strftime('%X', d) FROM dates ORDER BY d;
----
NULL
00:00:00
00:00:00
00:00:00
00:00:00


query I
SELECT strftime('XX%cXX%xXX%XXX', d) FROM dates ORDER BY d;
----
NULL
XX1992-01-01 00:00:00XX1992-01-01XX00:00:00XX
XX1993-03-20 00:00:00XX1993-03-20XX00:00:00XX
XX2020-08-09 00:00:00XX2020-08-09XX00:00:00XX
XX2020-08-10 00:00:00XX2020-08-10XX00:00:00XX
