# name: test/sql/function/table/sql_auto_complete.test
# description: Test sql_auto_complete
# group: [table]

require autocomplete

# CREATE
query II
FROM sql_auto_complete('CR') LIMIT 1;
----
CREATE 	0

# match case
query II
FROM sql_auto_complete('cr') LIMIT 1;
----
create 	0

query II
FROM sql_auto_complete('CREATE TA') LIMIT 1;
----
TABLE 	7

query II
FROM sql_auto_complete('create ta') LIMIT 1;
----
TABLE 	7

# suggest a type
query II
FROM sql_auto_complete('create table tbl(i INTE') LIMIT 1;
----
INTEGER	19

## suggest a type in a list
#query II
#FROM sql_auto_complete('create table tbl(i INTEGER, j INTE') LIMIT 1;
#----
#
## suggest a constraint
#query II
#FROM sql_auto_complete('create table tbl(i INTEGER PRI') LIMIT 1;
#----

#query II
#FROM sql_auto_complete('create table tbl(i INTEGER PRIMARY KE') LIMIT 1;
#----
#
## suggest a stand-alone constraint
#query II
#FROM sql_auto_complete('create table tbl(i INTEGER, PRI') LIMIT 1;
#----

statement ok
CREATE SCHEMA abcdefgh;

# suggest a schema name
query II
FROM sql_auto_complete('CREATE TABLE abcd') LIMIT 1;
----
abcdefgh	13

# suggest a catalog
statement ok
ATTACH ':memory:' AS attached_in_memory;

query II
FROM sql_auto_complete('CREATE TABLE attac') LIMIT 1;
----
attached_in_memory	13

query II
FROM sql_auto_complete('CREATE TABLE attached_in_memory.a') LIMIT 1;
----
abcdefgh 	13

# nothing to suggest after CREATE FUNCTION
query II
FROM sql_auto_complete('CREATE FUNCTION abcd') LIMIT 1;
----

statement error
FROM sql_auto_complete(NULL);
----
Binder Error: sql_auto_complete first parameter cannot be NULL
