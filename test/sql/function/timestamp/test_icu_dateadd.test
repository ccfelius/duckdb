# name: test/sql/function/timestamp/test_icu_dateadd.test
# description: Test ICU date + interval functionality
# group: [timestamp]

require icu

statement ok
SET TimeZone = 'America/Los_Angeles';

# Quick syntax check
query T
SELECT '2021-12-01 13:54:48'::TIMESTAMPTZ + INTERVAL 1 DAY;
----
2021-12-02 13:54:48+00

# Various intervals
statement ok
CREATE TABLE intervals AS SELECT iv FROM (VALUES
	(INTERVAL 1 year),
	(INTERVAL (-1) year),
	(INTERVAL 1 month),
	(INTERVAL (-1) month),
	(INTERVAL 13 month),
	(INTERVAL (-15) month),
	(INTERVAL 1 day),
	(INTERVAL (-1) day),
	(INTERVAL 32 day),
	(INTERVAL (-40) day),
	(INTERVAL 1 hour),
	(INTERVAL (-1) hour),
	(INTERVAL 11 hour),
	(INTERVAL (-14) hour),
	(INTERVAL 1 minute),
	(INTERVAL (-1) minute),
	(INTERVAL 6 minute),
	(INTERVAL (-72) minute),
	(INTERVAL 1 second),
	(INTERVAL (-1) second),
	(INTERVAL 23 second),
	(INTERVAL (-118) second),
	(INTERVAL 1 millisecond),
	(INTERVAL (-1) millisecond),
	(INTERVAL 910 millisecond),
	(INTERVAL (-150) millisecond),
	(INTERVAL 1 microsecond),
	(INTERVAL (-1) microsecond),
	(INTERVAL 612 microsecond),
	(INTERVAL (-485) microsecond)
) tbl(iv);

query II
SELECT iv, '2021-12-01 13:54:48.123456'::TIMESTAMPTZ + iv FROM intervals;
----
1 year	2022-12-01 13:54:48.123456+00
-1 years	2020-12-01 13:54:48.123456+00
1 month	2022-01-01 13:54:48.123456+00
-1 months	2021-11-01 12:54:48.123456+00
1 year 1 month	2023-01-01 13:54:48.123456+00
-1 years -3 months	2020-09-01 12:54:48.123456+00
1 day	2021-12-02 13:54:48.123456+00
-1 days	2021-11-30 13:54:48.123456+00
32 days	2022-01-02 13:54:48.123456+00
-40 days	2021-10-22 12:54:48.123456+00
01:00:00	2021-12-01 14:54:48.123456+00
-01:00:00	2021-12-01 12:54:48.123456+00
11:00:00	2021-12-02 00:54:48.123456+00
-14:00:00	2021-11-30 23:54:48.123456+00
00:01:00	2021-12-01 13:55:48.123456+00
-00:01:00	2021-12-01 13:53:48.123456+00
00:06:00	2021-12-01 14:00:48.123456+00
-01:12:00	2021-12-01 12:42:48.123456+00
00:00:01	2021-12-01 13:54:49.123456+00
-00:00:01	2021-12-01 13:54:47.123456+00
00:00:23	2021-12-01 13:55:11.123456+00
-00:01:58	2021-12-01 13:52:50.123456+00
00:00:00.001	2021-12-01 13:54:48.124456+00
-00:00:00.001	2021-12-01 13:54:48.122456+00
00:00:00.91	2021-12-01 13:54:49.033456+00
-00:00:00.15	2021-12-01 13:54:47.973456+00
00:00:00.000001	2021-12-01 13:54:48.123457+00
-00:00:00.000001	2021-12-01 13:54:48.123455+00
00:00:00.000612	2021-12-01 13:54:48.124068+00
-00:00:00.000485	2021-12-01 13:54:48.122971+00
