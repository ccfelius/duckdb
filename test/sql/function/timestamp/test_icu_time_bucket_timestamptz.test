# name: test/sql/function/timestamp/test_icu_time_bucket_timestamptz.test
# description: Test time bucket functionality
# group: [timestamp]

require icu

statement ok
SET Calendar = 'gregorian';

statement ok
SET TimeZone = 'America/Los_Angeles';

statement ok
CREATE TABLE timestamps_tz(w INTERVAL, t TIMESTAMPTZ, shift INTERVAL, origin TIMESTAMPTZ, timezone VARCHAR);

statement ok
INSERT INTO timestamps_tz VALUES ('10 days', '-infinity', '0 days', '1970-01-05 00:00:00+00', 'UTC'),
	('333 microseconds', '1971-12-02 02:02:03.003003+00', '0 microseconds', '1970-01-05 00:00:00+00', 'UTC'),
	('333 microseconds', '1973-12-03 02:02:04.003003+03', '444 microseconds', '1970-01-05 00:05:05.006006+03', 'America/Los_Angeles'),
	('333 microseconds', '1979-12-04 02:02:05.003003-03', '-444 microseconds', '1970-01-05 00:05:05.006006-03', 'America/Los_Angeles'),
	('333 milliseconds', '1981-12-05 02:02:06.003003+00', '0 milliseconds', '1970-01-05 00:00:00+00', 'UTC'),
	('333 milliseconds', '1982-12-06 02:02:07.003003+04', '444 milliseconds', '1970-01-05 00:05:05.006006+04', 'Asia/Baghdad'),
	('333 milliseconds', '1985-12-07 02:02:08.003003-04', '-444 milliseconds', '1970-01-05 00:05:05.006006-04', 'Asia/Baghdad'),
	('333 seconds', '1989-12-08 02:02:09.003003+00', '0 seconds', '1970-01-05 00:00:00+00', 'UTC'),
	('333 seconds', '1990-12-09 02:02:10.003003+02', '444 seconds', '1970-01-05 00:05:05.006006+02', 'Australia/Sydney'),
	('333 seconds', '1991-12-10 02:02:11.003003-02', '-444 seconds', '1970-01-05 00:05:05.006006-02', 'Australia/Sydney'),
	('333 minutes', '1992-12-11 02:02:12.003003+00', '0 minutes', '1970-01-05 00:00:00+00', 'UTC'),
	('333 minutes', '1994-12-12 02:02:13.003003+05', '444 minute', '1970-01-05 00:05:05.006006+05', 'Europe/Berlin'),
	('333 minutes', '1997-12-13 02:02:14.003003-05', '-444 minute', '1970-01-05 00:05:05.006006-05', 'Europe/Berlin'),
	('333 hours', '1999-12-14 02:02:15.003003+00', '0 hours', '1970-01-05 00:00:00+00', 'UTC'),
	('333 hours', '2000-12-15 02:02:16.003003+01', '444 hours', '1970-01-05 00:05:05.006006+01', 'Europe/London'),
	('333 hours', '2004-12-16 02:02:17.003003-01', '-444 hours', '1970-01-05 00:05:05.006006-01', 'Europe/London'),
	('10 days', '2008-12-17 02:02:18.003003+00', '0 days', '1970-01-05 00:00:00+00', 'UTC'),
	('1 week', '2010-12-18 02:02:19.003003+00', '0 days', '1970-01-05 00:00:00+00', 'UTC'),
	('10 days', '2013-12-19 02:02:20.003003+02', '2 days 4 hours', '1970-01-07 00:05:05.006006+02', 'Asia/Kolkata'),
	('10 days', '2014-12-20 02:02:21.003003-02', '-2 days 4 hours', '1970-01-03 00:05:05.006006-02', 'Asia/Kolkata'),
	('2 months', '2016-12-21 02:02:22.003003+00', '0 months', '1970-01-05 00:00:00+00', 'UTC'),
	('2 months', '2018-12-22 02:02:23.003003+09', '1 month 1 week', '1970-02-01 00:05:05.006006+09', 'Asia/Shanghai'),
	('2 months', '2019-12-23 02:02:24.003003-09', '-1 month 1 week', '1969-12-01 00:05:05.006006-09', 'Asia/Shanghai'),
	('2 year', '2020-12-24 02:02:25.003003+11', '6 months', '1970-07-01 00:05:05.006006+11', 'Asia/Yekaterinburg'),
	('2 year', '2022-12-25 02:02:26.003003-11', '-6 months', '1969-07-01 00:05:05.006006-11', 'Asia/Yekaterinburg'),
	('10 days', '2024-12-25 02:02:26.003003+07', '1 year', '-infinity', 'Asia/Tokyo'),
	('10 days', '2032-12-25 02:02:26.003003-07', '-1 year', 'infinity', 'Asia/Tokyo'),
	('10 days', 'infinity', '0 days', '1970-01-01 00:00:00+00', 'UTC');

query I
select time_bucket('56 seconds'::interval, t) from timestamps_tz;
----
-infinity
1971-12-01 18:01:44-08
1973-12-02 15:01:12-08
1979-12-03 21:01:36-08
1981-12-04 18:02:00-08
1982-12-05 14:01:28-08
1985-12-06 22:01:52-08
1989-12-07 18:01:52-08
1990-12-08 16:01:44-08
1991-12-09 20:01:52-08
1992-12-10 18:01:52-08
1994-12-11 13:01:44-08
1997-12-12 23:01:36-08
1999-12-13 18:01:28-08
2000-12-14 17:02:08-08
2004-12-15 19:01:28-08
2008-12-16 18:01:36-08
2010-12-17 18:02:00-08
2013-12-18 16:02:16-08
2014-12-19 20:01:28-08
2016-12-20 18:01:36-08
2018-12-21 09:01:36-08
2019-12-23 03:01:44-08
2020-12-23 07:01:52-08
2022-12-25 05:02:00-08
2024-12-24 11:01:36-08
2032-12-25 01:02:00-08
infinity

query I
select time_bucket('3 days'::interval, t) from timestamps_tz;
----
-infinity
1971-11-30 16:00:00-08
1973-12-01 16:00:00-08
1979-12-03 16:00:00-08
1981-12-04 16:00:00-08
1982-12-02 16:00:00-08
1985-12-04 16:00:00-08
1989-12-07 16:00:00-08
1990-12-08 16:00:00-08
1991-12-09 16:00:00-08
1992-12-09 16:00:00-08
1994-12-08 16:00:00-08
1997-12-10 16:00:00-08
1999-12-12 16:00:00-08
2000-12-12 16:00:00-08
2004-12-15 16:00:00-08
2008-12-15 16:00:00-08
2010-12-17 16:00:00-08
2013-12-16 16:00:00-08
2014-12-17 16:00:00-08
2016-12-18 16:00:00-08
2018-12-20 16:00:00-08
2019-12-21 16:00:00-08
2020-12-21 16:00:00-08
2022-12-23 16:00:00-08
2024-12-21 16:00:00-08
2032-12-24 16:00:00-08
infinity

query I
select time_bucket('3 years'::interval, t) from timestamps_tz;
----
-infinity
1969-12-31 16:00:00-08
1972-12-31 16:00:00-08
1978-12-31 16:00:00-08
1978-12-31 16:00:00-08
1981-12-31 16:00:00-08
1984-12-31 16:00:00-08
1987-12-31 16:00:00-08
1987-12-31 16:00:00-08
1990-12-31 16:00:00-08
1990-12-31 16:00:00-08
1993-12-31 16:00:00-08
1996-12-31 16:00:00-08
1996-12-31 16:00:00-08
1999-12-31 16:00:00-08
2002-12-31 16:00:00-08
2005-12-31 16:00:00-08
2008-12-31 16:00:00-08
2011-12-31 16:00:00-08
2011-12-31 16:00:00-08
2014-12-31 16:00:00-08
2017-12-31 16:00:00-08
2017-12-31 16:00:00-08
2017-12-31 16:00:00-08
2020-12-31 16:00:00-08
2023-12-31 16:00:00-08
2029-12-31 16:00:00-08
infinity

query I
select time_bucket(null::interval, t) from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket('3 years'::interval, null::timestamptz) from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket(w, t) from timestamps_tz;
----
-infinity
1971-12-01 18:02:03.002865-08
1973-12-02 15:02:04.0029-08
1979-12-03 21:02:05.002899-08
1981-12-04 18:02:05.937-08
1982-12-05 14:02:06.963-08
1985-12-06 22:02:07.791-08
1989-12-07 18:01:30-08
1990-12-08 15:58:30-08
1991-12-09 20:01:48-08
1992-12-10 12:51:00-08
1994-12-11 12:24:00-08
1997-12-12 19:09:00-08
1999-12-05 22:00:00-08
2000-12-14 13:00:00-08
2004-12-10 10:00:00-08
2008-12-15 16:00:00-08
2010-12-12 16:00:00-08
2013-12-09 16:00:00-08
2014-12-14 16:00:00-08
2016-10-31 17:00:00-07
2018-10-31 17:00:00-07
2019-10-31 17:00:00-07
2019-12-31 16:00:00-08
2021-12-31 16:00:00-08
2024-12-21 16:00:00-08
2032-12-19 16:00:00-08
infinity

query I
select time_bucket('4 seconds'::interval, t, '2 seconds'::interval) from timestamps_tz;
----
-infinity
1971-12-01 18:02:02-08
1973-12-02 15:02:02-08
1979-12-03 21:02:02-08
1981-12-04 18:02:06-08
1982-12-05 14:02:06-08
1985-12-06 22:02:06-08
1989-12-07 18:02:06-08
1990-12-08 16:02:10-08
1991-12-09 20:02:10-08
1992-12-10 18:02:10-08
1994-12-11 13:02:10-08
1997-12-12 23:02:14-08
1999-12-13 18:02:14-08
2000-12-14 17:02:14-08
2004-12-15 19:02:14-08
2008-12-16 18:02:18-08
2010-12-17 18:02:18-08
2013-12-18 16:02:18-08
2014-12-19 20:02:18-08
2016-12-20 18:02:22-08
2018-12-21 09:02:22-08
2019-12-23 03:02:22-08
2020-12-23 07:02:22-08
2022-12-25 05:02:26-08
2024-12-24 11:02:26-08
2032-12-25 01:02:26-08
infinity

query I
select time_bucket('4 days'::interval, t, '6 hours'::interval) from timestamps_tz;
----
-infinity
1971-11-30 22:00:00-08
1973-12-01 22:00:00-08
1979-12-02 22:00:00-08
1981-12-03 22:00:00-08
1982-12-02 22:00:00-08
1985-12-06 22:00:00-08
1989-12-05 22:00:00-08
1990-12-04 22:00:00-08
1991-12-07 22:00:00-08
1992-12-09 22:00:00-08
1994-12-07 22:00:00-08
1997-12-11 22:00:00-08
1999-12-09 22:00:00-08
2000-12-11 22:00:00-08
2004-12-14 22:00:00-08
2008-12-13 22:00:00-08
2010-12-15 22:00:00-08
2013-12-15 22:00:00-08
2014-12-18 22:00:00-08
2016-12-19 22:00:00-08
2018-12-17 22:00:00-08
2019-12-20 22:00:00-08
2020-12-22 22:00:00-08
2022-12-24 22:00:00-08
2024-12-21 22:00:00-08
2032-12-23 22:00:00-08
infinity

query I
select time_bucket('3 months'::interval, t, '6 days 11 hours'::interval) from timestamps_tz;
----
-infinity
1971-10-07 04:00:00-07
1973-10-07 04:00:00-07
1979-10-07 04:00:00-07
1981-10-07 04:00:00-07
1982-10-07 04:00:00-07
1985-10-07 04:00:00-07
1989-10-07 04:00:00-07
1990-10-07 04:00:00-07
1991-10-07 04:00:00-07
1992-10-07 04:00:00-07
1994-10-07 04:00:00-07
1997-10-07 04:00:00-07
1999-10-07 04:00:00-07
2000-10-07 04:00:00-07
2004-10-07 04:00:00-07
2008-10-07 04:00:00-07
2010-10-07 04:00:00-07
2013-10-07 04:00:00-07
2014-10-07 04:00:00-07
2016-10-07 04:00:00-07
2018-10-07 04:00:00-07
2019-10-07 04:00:00-07
2020-10-07 04:00:00-07
2022-10-07 04:00:00-07
2024-10-07 04:00:00-07
2032-10-07 04:00:00-07
infinity

query I
select time_bucket(null::interval, t, '2 seconds'::interval) from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket('3 months'::interval, null::timestamptz, '2 seconds'::interval) from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket('3 months'::interval, t, null::interval) from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket(w, t, shift) from timestamps_tz;
----
-infinity
1971-12-01 18:02:03.002865-08
1973-12-02 15:02:04.002678-08
1979-12-03 21:02:05.002788-08
1981-12-04 18:02:05.937-08
1982-12-05 14:02:06.741-08
1985-12-06 22:02:07.68-08
1989-12-07 18:01:30-08
1990-12-08 16:00:21-08
1991-12-09 19:59:57-08
1992-12-10 12:51:00-08
1994-12-11 08:42:00-08
1997-12-12 22:51:00-08
1999-12-05 22:00:00-08
2000-12-05 07:00:00-08
2004-12-05 19:00:00-08
2008-12-15 16:00:00-08
2010-12-12 16:00:00-08
2013-12-11 20:00:00-08
2014-12-12 20:00:00-08
2016-10-31 17:00:00-07
2018-12-07 16:00:00-08
2019-12-07 16:00:00-08
2020-06-30 17:00:00-07
2021-06-30 17:00:00-07
2024-12-17 16:00:00-08
2032-12-24 16:00:00-08
infinity

query I
select time_bucket('11 seconds'::interval, t, '1990-12-10 08:08:10+03'::timestamptz) from timestamps_tz;
----
-infinity
1971-12-01 18:02:03-08
1973-12-02 15:01:58-08
1979-12-03 21:01:55-08
1981-12-04 18:02:01-08
1982-12-05 14:02:06-08
1985-12-06 22:02:00-08
1989-12-07 18:02:07-08
1990-12-08 16:02:06-08
1991-12-09 20:02:09-08
1992-12-10 18:02:02-08
1994-12-11 13:02:09-08
1997-12-12 23:02:08-08
1999-12-13 18:02:15-08
2000-12-14 17:02:16-08
2004-12-15 19:02:16-08
2008-12-16 18:02:14-08
2010-12-17 18:02:17-08
2013-12-18 16:02:19-08
2014-12-19 20:02:11-08
2016-12-20 18:02:14-08
2018-12-21 09:02:22-08
2019-12-23 03:02:16-08
2020-12-23 07:02:19-08
2022-12-25 05:02:22-08
2024-12-24 11:02:24-08
2032-12-25 01:02:17-08
infinity

query I
select time_bucket('11 days'::interval, t, '1990-01-06 08:08:10+09'::timestamptz) from timestamps_tz;
----
-infinity
1971-11-30 15:08:10-08
1973-11-25 15:08:10-08
1979-11-23 15:08:10-08
1981-11-29 15:08:10-08
1982-11-27 15:08:10-08
1985-12-01 15:08:10-08
1989-12-03 15:08:10-08
1990-12-01 15:08:10-08
1991-11-29 15:08:10-08
1992-12-07 15:08:10-08
1994-12-03 15:08:10-08
1997-12-07 15:08:10-08
1999-12-03 15:08:10-08
2000-12-11 15:08:10-08
2004-12-13 15:08:10-08
2008-12-15 15:08:10-08
2010-12-11 15:08:10-08
2013-12-15 15:08:10-08
2014-12-13 15:08:10-08
2016-12-19 15:08:10-08
2018-12-15 15:08:10-08
2019-12-13 15:08:10-08
2020-12-21 15:08:10-08
2022-12-17 15:08:10-08
2024-12-23 15:08:10-08
2032-12-16 15:08:10-08
infinity

query I
select time_bucket('7 months'::interval, t, '1990-01-06 08:08:10+01'::timestamptz) from timestamps_tz;
----
-infinity
1971-11-30 16:00:00-08
1973-08-31 17:00:00-07
1979-06-30 17:00:00-07
1981-10-31 16:00:00-08
1982-05-31 17:00:00-07
1985-11-30 16:00:00-08
1989-05-31 17:00:00-07
1990-07-31 17:00:00-07
1991-09-30 17:00:00-07
1992-11-30 16:00:00-08
1994-08-31 17:00:00-07
1997-07-31 17:00:00-07
1999-11-30 16:00:00-08
2000-06-30 17:00:00-07
2004-07-31 17:00:00-07
2008-08-31 17:00:00-07
2010-05-31 17:00:00-07
2013-11-30 16:00:00-08
2014-06-30 17:00:00-07
2016-10-31 17:00:00-07
2018-07-31 17:00:00-07
2019-09-30 17:00:00-07
2020-11-30 16:00:00-08
2022-08-31 17:00:00-07
2024-05-31 17:00:00-07
2032-07-31 17:00:00-07
infinity

query I
select time_bucket(null::interval, t, '1990-01-06 08:08:10'::timestamptz) from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket('7 months'::interval, null::timestamptz, '1990-01-06 08:08:10'::timestamptz) from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket('7 months'::interval, t, null::timestamptz) from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket(w, t, origin) from timestamps_tz;
----
-infinity
1971-12-01 18:02:03.002739-08
1973-12-02 15:02:04.002947-08
1979-12-03 21:02:05.002901-08
1981-12-04 18:02:05.811-08
1982-12-05 14:02:06.734006-08
1985-12-06 22:02:07.724006-08
1989-12-07 17:59:24-08
1990-12-08 15:58:02.006006-08
1991-12-09 19:57:08.006006-08
1992-12-10 13:00:00-08
1994-12-11 07:38:05.006006-08
1997-12-12 18:50:05.006006-08
1999-12-12 04:00:00-08
2000-12-06 21:05:05.006006-08
2004-12-02 20:05:05.006006-08
2008-12-10 16:00:00-08
2010-12-12 16:00:00-08
2013-12-16 14:05:05.006006-08
2014-12-17 18:05:05.006006-08
2016-10-31 17:00:00-07
2018-10-31 17:00:00-07
2019-11-30 16:00:00-08
2020-05-31 17:00:00-07
2021-06-30 17:00:00-07
NULL
NULL
infinity

query I
select time_bucket('11 seconds'::interval, t, 'Asia/Calcutta') from timestamps_tz;
----
-infinity
1971-12-01 18:01:53-08
1973-12-02 15:01:59-08
1979-12-03 21:01:56-08
1981-12-04 18:02:02-08
1982-12-05 14:02:07-08
1985-12-06 22:02:01-08
1989-12-07 18:02:08-08
1990-12-08 16:02:07-08
1991-12-09 20:02:10-08
1992-12-10 18:02:03-08
1994-12-11 13:02:10-08
1997-12-12 23:02:09-08
1999-12-13 18:02:05-08
2000-12-14 17:02:06-08
2004-12-15 19:02:17-08
2008-12-16 18:02:15-08
2010-12-17 18:02:18-08
2013-12-18 16:02:20-08
2014-12-19 20:02:12-08
2016-12-20 18:02:15-08
2018-12-21 09:02:23-08
2019-12-23 03:02:17-08
2020-12-23 07:02:20-08
2022-12-25 05:02:23-08
2024-12-24 11:02:25-08
2032-12-25 01:02:18-08
infinity

query I
select time_bucket(null::interval, t, 'Asia/Calcutta') from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket('11 seconds'::interval, null::timestamptz, 'Asia/Calcutta') from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket('11 seconds'::interval, t, null::text) from timestamps_tz;
----
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL
NULL

query I
select time_bucket(w, t, timezone) from timestamps_tz;
----
-infinity
1971-12-01 18:02:03.002865-08
1973-12-02 15:02:04.002729-08
1979-12-03 21:02:05.002728-08
1981-12-04 18:02:05.937-08
1982-12-05 14:02:06.819-08
1985-12-06 22:02:07.98-08
1989-12-07 18:01:30-08
1990-12-08 15:58:57-08
1991-12-09 19:56:42-08
1992-12-10 12:51:00-08
1994-12-11 11:24:00-08
1997-12-12 18:09:00-08
1999-12-05 22:00:00-08
2000-12-14 13:00:00-08
2004-12-10 10:00:00-08
2008-12-15 16:00:00-08
2010-12-12 16:00:00-08
2013-12-09 10:30:00-08
2014-12-14 10:30:00-08
2016-10-31 17:00:00-07
2018-10-31 09:00:00-07
2019-10-31 09:00:00-07
2019-12-31 11:00:00-08
2021-12-31 11:00:00-08
2024-12-21 07:00:00-08
2032-12-19 07:00:00-08
infinity

statement error
select time_bucket('-3 hours'::interval, '2019-04-05 00:00:00+03'::timestamptz);

statement error
select time_bucket('-3 hours'::interval, '2019-04-05 00:00:00+03'::timestamptz, '1 hour 30 minutes'::interval);

statement error
select time_bucket('-3 hours'::interval, '2019-04-05 00:00:00+03'::timestamptz, '2019-04-05 00:00:00+03'::timestamptz);

statement error
select time_bucket('-1 month'::interval, '2019-04-05 00:00:00-11'::timestamptz);

statement error
select time_bucket('-1 month'::interval, '2019-04-05 00:00:00-11'::timestamptz, '1 hour 30 minutes'::interval);

statement error
select time_bucket('-1 month'::interval, '2019-04-05 00:00:00-11'::timestamptz, '2018-04-05 00:00:00+11'::timestamptz);

statement error
select time_bucket('1 day - 172800 seconds'::interval, '2018-05-05 00:00:00+07'::timestamptz);

statement error
select time_bucket('1 day - 172800 seconds'::interval, '2018-05-05 00:00:00+07'::timestamptz, '1 hour 30 minutes'::interval);

statement error
select time_bucket('1 day - 172800 seconds'::interval, '2018-05-05 00:00:00+07'::timestamptz, '2018-05-05 00:00:00+07'::timestamptz);

statement error
select time_bucket('1 month 1 day'::interval, '2018-05-05 00:00:00+02'::timestamptz);

statement error
select time_bucket('1 month 1 day'::interval, '2018-05-05 00:00:00+02'::timestamptz, '1 hour 30 minutes'::interval);

statement error
select time_bucket('1 month 1 day'::interval, '2018-05-05 00:00:00+02'::timestamptz, '2018-05-05 00:00:00+02'::timestamptz);

statement error
select time_bucket('3 days'::interval, '2019-05-05 00:00:00+09'::timestamptz, '2000000000 months'::interval);

statement error
select time_bucket('3 days'::interval, '2019-05-05 00:00:00+09'::timestamptz, '-2000000000 months'::interval);

statement error
select time_bucket('3 months'::interval, '2019-05-05 00:00:00+00'::timestamptz, '2000000000 months'::interval);

statement error
select time_bucket('3 months'::interval, '2019-05-05 00:00:00+00'::timestamptz, '-2000000000 months'::interval);

statement error
select time_bucket('1 microseconds'::interval, '290309-12-21 (BC) 23:59:59.999999'::timestamptz);
