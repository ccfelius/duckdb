# name: test/sql/function/timestamp/test_icu_datepart.test
# description: Test moving ICU date part functions
# group: [timestamp]

require icu

statement ok
CREATE TABLE timestamps AS SELECT ts::TIMESTAMP AS ts FROM (VALUES
	('2021-01-01 00:00:00'),
	('2021-02-02 00:00:00'),
	('2021-11-26 10:15:13.123456'),
	('2021-11-15 02:30:00-08'),
	('2021-11-15 02:30:00-07'),
	('2021-12-25 00:00:00+02')
) tbl(ts);

query II
SELECT icu_year(ts), year(ts) FROM timestamps;
----
2020	2021
2021	2021
2021	2021
2021	2021
2021	2021
2021	2021

# TODO: Add 1
query II
SELECT icu_month(ts), month(ts) FROM timestamps;
----
11	1
1	2
10	11
10	11
10	11
11	12

query II
SELECT icu_day(ts), day(ts) FROM timestamps;
----
31	1
1	2
26	26
15	15
15	15
24	24

# TODO: Add 1
query II
SELECT icu_dayofweek(ts), dayofweek(ts) FROM timestamps;
----
5	5
2	2
6	5
2	1
2	1
6	5

query II
SELECT icu_dayofyear(ts), dayofyear(ts) FROM timestamps;
----
366	1
32	33
330	330
319	319
319	319
358	358

# TODO: Correct(?)
query II
SELECT icu_week(ts), week(ts) FROM timestamps;
----
1	53
6	5
48	47
47	45
47	45
52	51

query II
SELECT icu_hour(ts), hour(ts) FROM timestamps;
----
16	0
16	0
2	10
2	10
1	9
14	22

query II
SELECT icu_minute(ts), minute(ts) FROM timestamps;
----
0	0
0	0
15	15
30	30
30	30
0	0

query II
SELECT icu_second(ts), second(ts) FROM timestamps;
----
0	0
0	0
13	13
0	0
0	0
0	0

# TODO: Include seconds(!)
query II
SELECT icu_millisecond(ts), millisecond(ts) FROM timestamps;
----
0	0
0	0
123	13123
0	0
0	0
0	0
