# name: test/sql/aggregate/aggregates/histogram.test
# description: Test list_histogram aggregate function
# group: [list]

statement ok
PRAGMA enable_verification

query I
select list_histogram(NULL)
----
NULL

query I
select list_histogram([NULL])
----
NULL

query I
select list_histogram([])
----
NULL

statement ok
CREATE TABLE const AS SELECT LIST(2) AS i FROM range(200) t1(i)

query I
SELECT list_histogram(i) FROM const WHERE 1 = 0;
----

query I
SELECT list_histogram(i) FROM const
----
{2=200}

query I
select list_histogram([1])
----
{1=1}

statement ok
CREATE TABLE hist_data (g INTEGER[])

statement ok
INSERT INTO hist_data VALUES ([1, 1, 2, 2, 2, 3, 5]), ([1, 2, 3, 4, 5, 6, NULL]), ([]), (NULL), ([NULL]);

query T
SELECT list_histogram(g) from hist_data
----
{1=2, 2=3, 3=1, 5=1}
{1=1, 2=1, 3=1, 4=1, 5=1, 6=1}
NULL
NULL
NULL

statement ok
create table names (name string[])

statement ok
insert into names values (['pedro', 'pedro', 'pedro', 'hannes', 'hannes', 'mark', NULL, 'Hubert Blaine Wolfeschlegelsteinhausenbergerdorff Sr.']);

query I
select list_histogram(name) from names;
----
{Hubert Blaine Wolfeschlegelsteinhausenbergerdorff Sr.=1, hannes=2, mark=1, pedro=3}

statement error
select list_histogram()

statement error
select list_histogram(*)