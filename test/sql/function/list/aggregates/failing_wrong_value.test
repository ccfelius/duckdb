# name: test/sql/function/list/aggregates/failing_wrong_value.test
# description: Tests failing due to an error with a wrong value
# group: [list]

#---- count.test ----#

statement ok
CREATE TABLE lists (l INTEGER[]);

statement ok
INSERT INTO lists VALUES ([1, 2]), ([NULL]), (NULL), ([]), ([3, 4, 5, 6, 7]), ([1, 2, NULL, 1, NULL]);

# this has 0 instead of NULL
query I
SELECT list_count(l) FROM lists
----
2
0
NULL
0
5
3

#---- entropy.test ----#

statement ok
create table aggr(k int[]);

statement ok
insert into aggr values ([0, 1, 1, 1, 4, 0, 3, 3, 2, 2, 4, 4, 2, 4, 0, 0, 0, 1, 2, 3, 4, 2, 3, 3, 1]);

statement ok
insert into aggr values ([]), ([NULL]), (NULL), ([0, 1, 1, 1, 4, NULL, 0, 3, 3, 2, NULL, 2, 4, 4, 2, 4, 0, 0, 0, 1, NULL, 2, 3, 4, 2, 3, 3, 1]);

# this has 0 instead of NULL
query I
select list_entropy(k) from aggr ;
----
2.321928
0
0
NULL
2.321928

#---- median.test ----#

statement ok
CREATE TABLE range AS SELECT LIST(1) AS i FROM range(2000) t1(i)

statement ok
INSERT INTO range VALUES (NULL), ([]), ([NULL]);

# fails with wrong (very small negative) value
query I
SELECT list_median(i) FROM range
----
1
NULL
NULL
NULL