# name: test/sql/function/list/aggregates/failing_complex_types.test
# description: Tests failing due to an error with complex types
# group: [list]

# these fail because the simple_update does not exist
#---- last.test ----#

# complex types
statement ok
CREATE TABLE five_complex AS
	SELECT
		LIST(i::integer) AS i,
		LIST(i::VARCHAR) AS s,
		LIST([i]) AS l,
		LIST({'a': i}) AS r
	FROM range(1, 6, 1) t1(i)

query III
SELECT list_last(s), list_last(l), list_last(r)
FROM five_complex
----
5	[5]	{'a': 5}

statement ok
DROP TABLE five_complex

#---- first.test ----#

# complex types
statement ok
CREATE TABLE five_complex AS
	SELECT
		LIST(i::integer) AS i,
		LIST(i::VARCHAR) AS s,
		LIST([i]) AS l,
		LIST({'a': i}) AS r
	FROM range(1, 6, 1) t1(i)

query III
SELECT list_first(s), list_first(l), list_first(r)
FROM five_complex
----
1	[1]	{'a': 1}

statement ok
DROP TABLE five_complex

#---- min.test ----#

# complex types
statement ok
CREATE TABLE five_complex AS
	SELECT
		LIST(i::integer) AS i,
		LIST(i::VARCHAR) AS s,
		LIST([i]) AS l,
		LIST({'a': i}) AS r
	FROM range(1, 6, 1) t1(i)

query III
SELECT list_min(s), list_min(l), list_min(r)
FROM five_complex
----
1	[1]	{'a': 1}

statement ok
DROP TABLE five_complex

