# name: test/sql/function/list/aggregates/bit_xor.test
# description: Test the list_bit_xor aggregate function
# group: [list]

# test on scalar values
query IIII
SELECT list_bit_xor([3]), list_bit_xor([NULL]), list_bit_xor(NULL), list_bit_xor([])
----
3	NULL	NULL	NULL

# test on a sequence
statement ok
CREATE SEQUENCE seq;

query I
SELECT list_bit_xor([nextval('seq')])
----
1

query I
SELECT list_bit_xor([nextval('seq')])
----
2

# test on a list of integers
statement ok
CREATE TABLE integers (i INTEGER[]);

statement ok
INSERT INTO integers VALUES ([3, 7, 15, 31, 3, 15]);

query I
SELECT list_bit_xor(i) FROM integers WHERE i > [100, 200]
----

# test on an empty list
query I
SELECT list_bit_xor([]) FROM integers
----
NULL

statement ok
INSERT INTO integers VALUES ([]), (NULL), ([NULL]), ([3, 7, NULL, 15, 31, 3, 15, NULL]);

query III
SELECT list_bit_xor(i), list_bit_xor([1, 1, 1, 1, 1, 1]), list_bit_xor(NULL) FROM integers
----
24	0	NULL
NULL	0	NULL
NULL	0	NULL
NULL	0	NULL
24	0	NULL

# test incorrect usage
statement error
SELECT list_bit_xor()

statement error
SELECT list_bit_xor(1, 2, 3)

statement error
SELECT list_bit_xor(list_bit_xor([1]))

statement error
SELECT list_bit_xor(['hello'])

statement error
SELECT list_bit_xor([True, False])

