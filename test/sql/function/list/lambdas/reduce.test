# name: test/sql/function/list/lambdas/reduce.test
# description: Test list_reduce function
# group: [lambdas]

statement ok
pragma enable_verification

query I
SELECT list_reduce([1, 2, 3], (x, y) -> x + y);
----
6

query I
SELECT list_reduce([1, 2, 3], (x, y) -> x * y);
----
6

query I
SELECT list_reduce([100, 10, 1], (x, y, i) -> x - y - i);
----
86

query I
SELECT list_reduce([1, 2, 3], (x, y) -> y - x);
----
2

query I
SELECT list_reduce([1, 2, 3], (x, y) -> x - y);
----
-4

query I
SELECT list_reduce([1, 2, 3], (x, y, i) -> x + y + i);
----
9

statement error
SELECT list_reduce([1, 2, 3], (x, y) -> (x * y)::VARCHAR || 'please work');
----
Could not convert

statement ok
CREATE table t1(a int[]);

statement ok
INSERT INTO t1 VALUES ([1, 2, 3]);

statement ok
INSERT INTO t1 VALUES ([666]);

statement ok
INSERT INTO t1 VALUES (NULL);

statement ok
INSERT INTO t1 VALUES ([44, 55]);

statement ok
INSERT INTO t1 VALUES ([-1, NULL, -2]);

query I
SELECT list_reduce(a, (x, y) -> x + y) FROM t1;
----
6
666
NULL
99
NULL

query I
SELECT list_reduce(a, (x, y, i) -> x + y + i) FROM t1;
----
9
666
NULL
100
NULL


