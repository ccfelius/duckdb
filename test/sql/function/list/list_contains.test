# name: test/sql/function/list/list_contains.test
# description: Test list_ccontains function
# group: [list]

statement ok
PRAGMA enable_verification

statement ok
create table TEST (i int[]);

statement ok
insert into TEST values ([2,1,3]), ([2,3,4]), ([1]);

query TT
SELECT i, list_contains(i,1) from TEST;
----
[2, 1, 3]	1
[2, 3, 4]	0
[1]	1

query TT
SELECT i, list_contains(i,4.0) from TEST;
----
[2, 1, 3]	0
[2, 3, 4]	1
[1]	0

statement ok
create table STR_TEST (i string[]);

statement ok
insert into STR_TEST values (['a','b','c']), (['d','a','e']), (['b']);

query TT
SELECT i, list_contains(i,'a') from STR_TEST;
----
[a, b, c]	1
[d, a, e]	1
[b]	0

query TT
SELECT i, list_contains(i,0) from STR_TEST;
----
[a, b, c]	0
[d, a, e]	0
[b]	0


query TT
SELECT i, list_contains(i,NULL) from STR_TEST;
----
[a, b, c]	NULL
[d, a, e]	NULL
[b]	NULL


# basic functionality
query T
SELECT list_contains([7,2,5], 7)
----
1

# Empty list
query T
SELECT list_contains([], 7)
----
0

# Mixed data types
query T
SELECT list_contains([1,2,3],1.0)
----
1

query T
SELECT list_contains([1.0,2.0,3.0,4.0],1)
----
1

query T
SELECT list_contains([1,2,3],4.0)
----
0

query T
SELECT list_contains([1.0,2.0,3.0],4)
----
0


query T
SELECT list_contains([1.0,2.0,3.0], 'a')
----
0

# Not a list as input
statement error
SELECT list_contains('a', 'a')

query T
SELECT list_contains(NULL,NULL)
----
NULL


query T
SELECT list_contains([7], 5)
----
0

query T
SELECT list_contains([1,2,3,4],4)
----
1

query T
SELECT list_contains([1,2,3,4],5)
----
0

query T
SELECT list_contains([1.0,2.0,3.0,4.0],5.0)
----
0

query T
SELECT list_contains([1.0,2.0,3.0,4.0],4.0)
----
1

query T
SELECT list_contains([true, false],true)
----
1

query T
SELECT list_contains([true, true],false)
----
0

query T
SELECT list_contains(['test', 'notest'],'notest')
----
1

query T
SELECT list_contains(['test', 'notest'],'a')
----
0

# Null types
query T
SELECT list_contains(NULL,1)
----
NULL

query T
SELECT list_contains([NULL],NULL)
----
NULL

query T
SELECT list_contains([NULL, 1],NULL)
----
NULL

query T
SELECT list_contains([NULL, 1],1)
----
1

query T
SELECT list_contains([NULL, 0],1)
----
0

query T
SELECT list_contains([],NULL)
----
NULL


query T
SELECT list_contains([NULL,7], 7)
----
1

statement error
SELECT list_contains([[1,2,3],[1],[1,2,3])




