# name: test/sql/join/external/simple_external_join.test
# description: Test simple external join
# group: [external]

load __TEST_DIR__/simple_external_join.db

statement ok
pragma verify_parallelism

# Create tables with large string values so that we have to swizzle strings
# The tables have some overlapping values to keep the join result small
statement ok
create table t1 as select concat(repeat('0', 50), range::VARCHAR) i from range(100000) order by random()

statement ok
create table t2 as select concat(repeat('0', 50), range::VARCHAR) j from range(90000, 500000) order by random()

statement ok
pragma debug_force_external=true

statement ok
pragma threads=4

statement ok
pragma memory_limit='50mb'

query I
select count(*) from t1, t2 where i = j
----
10000
