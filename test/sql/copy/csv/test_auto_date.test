# name: test/sql/copy/csv/test_auto_date.test
# description: Test the allow_quoted_nulls option
# group: [csv]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE date_tests (a DATE)

# -- Working cases (AUTO is Auto-Detected):
statement ok
copy date_tests from 'data/csv/auto_date/date_example_1.csv';

statement ok
copy date_tests from 'data/csv/auto_date/date_example_2.csv';

query I
FROM date_tests
----
2023-12-17
2023-12-14
2023-12-20
2023-12-17
2023-12-14
2023-12-20

statement ok
DROP TABLE date_tests

statement ok
CREATE TABLE date_tests (a DATE)

# -- Failed cases (AUTO is Set By User)
# -- file's date format is YYYY-MM-DD
statement ok
copy date_tests from 'data/csv/auto_date/date_example_1.csv' WITH (dateformat 'AUTO');


# -- file's date format is %m/%d/%y
statement ok
copy date_tests from 'data/csv/auto_date/date_example_2.csv' WITH (dateformat 'AUTO');

query I
FROM date_tests
----
2023-12-17
2023-12-14
2023-12-20
2023-12-17
2023-12-14
2023-12-20