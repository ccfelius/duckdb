# name: test/sql/copy/csv/csv_line_to_long.test
# description: Test that verifies that the CSV has long lines and properly errors that
# group: [csv]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE T1 (name VARCHAR);

statement ok
set threads=1

statement error
COPY T1(name) from 'data/csv/line_too_long.csv.gz' (DELIMITER ',', HEADER, COMPRESSION gzip, ALLOW_QUOTED_NULLS false, PARALLEL TRUE);
----
Maximum line size of 2097152 bytes exceeded on line 1!

#select count(*) from 'data/csv/line_too_long.csv.gz'
#----
#1
#
#select count(*) from 'data/csv/line_too_long_with_newline.csv.gz'
#----
#1
#
#select count(*) from 'data/csv/multiple_line_too_long.csv.gz'
#----
#1