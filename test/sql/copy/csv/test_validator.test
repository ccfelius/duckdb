# name: test/sql/copy/csv/test_validator.test
# description: Test that the validator throws on parallel files that do not properly fit
# group: [csv]

statement ok
PRAGMA enable_verification

require notwindows

query I
FROM read_csv('data/csv/validator/a.csv', header = 0)
----
123
123
123
one
123
123
123
123
123
123

statement error
FROM read_csv('data/csv/validator/a.csv', header = 0, columns = {'a': 'integer'}, auto_detect = false)
----
Error when converting column "a". Could not convert string "one" to 'INTEGER'

statement error
FROM read_csv('data/csv/validator/a.csv', header = 0, columns = {'a': 'integer'}, auto_detect = false, buffer_size = 11)
----
Not implemented Error: The Parallel CSV Reader currently does not support a full read on this file.

statement error
FROM read_csv('data/csv/validator/a.csv', header = 0, columns = {'a': 'integer'}, auto_detect = false, buffer_size = 11, parallel = false)
----
Error when converting column "a". Could not convert string "one" to 'INTEGER'