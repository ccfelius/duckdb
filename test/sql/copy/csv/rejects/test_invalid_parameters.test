# name: test/sql/copy/csv/rejects/test_invalid_parameters.test
# group: [rejects]

require skip_reload

# FIXME: https://github.com/duckdb/duckdb/issues/7755
require vector_size 2048

# Test invalid arguments
statement error
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad.csv',
    columns = {'col0': 'INTEGER', 'col1': 'INTEGER', 'col2': 'VARCHAR'},
    ignore_errors=false,
    rejects_table='csv_rejects_table'
)
----
only supported when IGNORE_ERRORS is set to true

statement error
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad.csv',
    columns = {'col0': 'INTEGER', 'col1': 'INTEGER', 'col2': 'VARCHAR'},
    ignore_errors=true,
    rejects_table='')
----
REJECTS_TABLE option cannot be empty

statement error
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad.csv',
    columns = {'col0': 'INTEGER', 'col1': 'INTEGER', 'col2': 'VARCHAR'},
    ignore_errors=true,
    rejects_table='csv_rejects_table',
    union_by_name=true)
----
UNION_BY_NAME is set to true

statement error
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad.csv',
    columns = {'col0': 'INTEGER', 'col1': 'INTEGER', 'col2': 'VARCHAR'},
    ignore_errors=true,
    rejects_limit=10)
----
REJECTS_LIMIT option is only supported when REJECTS_TABLE is set to a table name

statement error
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad.csv',
    columns = {'col0': 'INTEGER', 'col1': 'INTEGER', 'col2': 'VARCHAR'},
    ignore_errors=true,
    rejects_table='csv_rejects_table',
    rejects_limit=-1)
----
REJECTS_LIMIT: cannot be negative
