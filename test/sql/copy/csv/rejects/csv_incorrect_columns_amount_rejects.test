# name: test/sql/copy/csv/rejects/csv_incorrect_columns_amount_rejects.test
# description: Test that incorrect column amounts return correct info as rejects tables
# group: [rejects]

require skip_reload


statement ok
SELECT * FROM read_csv(
    'data/csv/rejects/incorrect_columns/few_columns.csv',
    columns = {'a': 'INTEGER', 'b': 'INTEGER', 'c': 'INTEGER', 'd': 'INTEGER'},
    rejects_table='csv_rejects_table',
    ignore_errors=true, auto_detect=false, header = 1);

query IIIIIII rowsort
SELECT regexp_replace(file, '\\', '/', 'g'), line, column_idx, column_name, error_type, csv_line, byte_position
FROM csv_rejects_table;
----
data/csv/rejects/incorrect_columns/few_columns.csv	1814	3	"d"	MISSING COLUMNS	1,2,3	14504
data/csv/rejects/incorrect_columns/few_columns.csv	1823	1	"b"	MISSING COLUMNS	1	14574
data/csv/rejects/incorrect_columns/few_columns.csv	2378	1	"b"	MISSING COLUMNS	1	19008
data/csv/rejects/incorrect_columns/few_columns.csv	2762	2	"c"	MISSING COLUMNS	1,2	22074