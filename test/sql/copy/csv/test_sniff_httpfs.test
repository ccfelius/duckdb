# name: test/sql/copy/csv/test_sniff_httpfs.test
# description: Test sniff_csv functions over httpfs with auto-detection on compression
# group: [csv]

statement ok
PRAGMA enable_verification

# requires notwindows because tests will return \r\n to be used in the parameters
require notwindows

require httpfs

query IIIIIIIIIIII
from sniff_csv('https://github.com/duckdb/duckdb/raw/main/data/csv/who.csv.gz');
----
,	"	"	\n	\0	0	true	[{'name': country, 'type': VARCHAR}, {'name': iso2, 'type': VARCHAR}, {'name': iso3, 'type': VARCHAR}, {'name': year, 'type': BIGINT}, {'name': new_sp_m014, 'type': BIGINT}, {'name': new_sp_m1524, 'type': BIGINT}, {'name': new_sp_m2534, 'type': BIGINT}, {'name': new_sp_m3544, 'type': BIGINT}, {'name': new_sp_m4554, 'type': BIGINT}, {'name': new_sp_m5564, 'type': BIGINT}, {'name': new_sp_m65, 'type': BIGINT}, {'name': new_sp_f014, 'type': BIGINT}, {'name': new_sp_f1524, 'type': BIGINT}, {'name': new_sp_f2534, 'type': BIGINT}, {'name': new_sp_f3544, 'type': BIGINT}, {'name': new_sp_f4554, 'type': BIGINT}, {'name': new_sp_f5564, 'type': BIGINT}, {'name': new_sp_f65, 'type': BIGINT}, {'name': new_sn_m014, 'type': BIGINT}, {'name': new_sn_m1524, 'type': BIGINT}, {'name': new_sn_m2534, 'type': BIGINT}, {'name': new_sn_m3544, 'type': BIGINT}, {'name': new_sn_m4554, 'type': BIGINT}, {'name': new_sn_m5564, 'type': BIGINT}, {'name': new_sn_m65, 'type': BIGINT}, {'name': new_sn_f014, 'type': BIGINT}, {'name': new_sn_f1524, 'type': BIGINT}, {'name': new_sn_f2534, 'type': BIGINT}, {'name': new_sn_f3544, 'type': BIGINT}, {'name': new_sn_f4554, 'type': BIGINT}, {'name': new_sn_f5564, 'type': BIGINT}, {'name': new_sn_f65, 'type': BIGINT}, {'name': new_ep_m014, 'type': BIGINT}, {'name': new_ep_m1524, 'type': BIGINT}, {'name': new_ep_m2534, 'type': BIGINT}, {'name': new_ep_m3544, 'type': BIGINT}, {'name': new_ep_m4554, 'type': BIGINT}, {'name': new_ep_m5564, 'type': BIGINT}, {'name': new_ep_m65, 'type': BIGINT}, {'name': new_ep_f014, 'type': BIGINT}, {'name': new_ep_f1524, 'type': BIGINT}, {'name': new_ep_f2534, 'type': BIGINT}, {'name': new_ep_f3544, 'type': BIGINT}, {'name': new_ep_f4554, 'type': BIGINT}, {'name': new_ep_f5564, 'type': BIGINT}, {'name': new_ep_f65, 'type': BIGINT}, {'name': newrel_m014, 'type': BIGINT}, {'name': newrel_m1524, 'type': BIGINT}, {'name': newrel_m2534, 'type': BIGINT}, {'name': newrel_m3544, 'type': BIGINT}, {'name': newrel_m4554, 'type': BIGINT}, {'name': newrel_m5564, 'type': BIGINT}, {'name': newrel_m65, 'type': BIGINT}, {'name': newrel_f014, 'type': BIGINT}, {'name': newrel_f1524, 'type': BIGINT}, {'name': newrel_f2534, 'type': BIGINT}, {'name': newrel_f3544, 'type': BIGINT}, {'name': newrel_f4554, 'type': BIGINT}, {'name': newrel_f5564, 'type': BIGINT}, {'name': newrel_f65, 'type': BIGINT}]	NULL	NULL	NULL	FROM read_csv('https://github.com/duckdb/duckdb/raw/main/data/csv/who.csv.gz', auto_detect=false, delim=',', quote='"', escape='"', new_line='\n', skip=0, comment='\0', header=true, columns={'country': 'VARCHAR', 'iso2': 'VARCHAR', 'iso3': 'VARCHAR', 'year': 'BIGINT', 'new_sp_m014': 'BIGINT', 'new_sp_m1524': 'BIGINT', 'new_sp_m2534': 'BIGINT', 'new_sp_m3544': 'BIGINT', 'new_sp_m4554': 'BIGINT', 'new_sp_m5564': 'BIGINT', 'new_sp_m65': 'BIGINT', 'new_sp_f014': 'BIGINT', 'new_sp_f1524': 'BIGINT', 'new_sp_f2534': 'BIGINT', 'new_sp_f3544': 'BIGINT', 'new_sp_f4554': 'BIGINT', 'new_sp_f5564': 'BIGINT', 'new_sp_f65': 'BIGINT', 'new_sn_m014': 'BIGINT', 'new_sn_m1524': 'BIGINT', 'new_sn_m2534': 'BIGINT', 'new_sn_m3544': 'BIGINT', 'new_sn_m4554': 'BIGINT', 'new_sn_m5564': 'BIGINT', 'new_sn_m65': 'BIGINT', 'new_sn_f014': 'BIGINT', 'new_sn_f1524': 'BIGINT', 'new_sn_f2534': 'BIGINT', 'new_sn_f3544': 'BIGINT', 'new_sn_f4554': 'BIGINT', 'new_sn_f5564': 'BIGINT', 'new_sn_f65': 'BIGINT', 'new_ep_m014': 'BIGINT', 'new_ep_m1524': 'BIGINT', 'new_ep_m2534': 'BIGINT', 'new_ep_m3544': 'BIGINT', 'new_ep_m4554': 'BIGINT', 'new_ep_m5564': 'BIGINT', 'new_ep_m65': 'BIGINT', 'new_ep_f014': 'BIGINT', 'new_ep_f1524': 'BIGINT', 'new_ep_f2534': 'BIGINT', 'new_ep_f3544': 'BIGINT', 'new_ep_f4554': 'BIGINT', 'new_ep_f5564': 'BIGINT', 'new_ep_f65': 'BIGINT', 'newrel_m014': 'BIGINT', 'newrel_m1524': 'BIGINT', 'newrel_m2534': 'BIGINT', 'newrel_m3544': 'BIGINT', 'newrel_m4554': 'BIGINT', 'newrel_m5564': 'BIGINT', 'newrel_m65': 'BIGINT', 'newrel_f014': 'BIGINT', 'newrel_f1524': 'BIGINT', 'newrel_f2534': 'BIGINT', 'newrel_f3544': 'BIGINT', 'newrel_f4554': 'BIGINT', 'newrel_f5564': 'BIGINT', 'newrel_f65': 'BIGINT'});