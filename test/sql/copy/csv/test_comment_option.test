# name: test/sql/copy/csv/test_comment_option.test
# description: Test that the comment option of csv reading works properly
# group: [csv]

statement ok
PRAGMA enable_verification

query II
FROM read_csv('data/csv/comments/simple.csv');
----
1	3
6	7

# Lets try over a vector size
query II
FROM read_csv('data/csv/comments/big.csv') limit 5;
----
1	3
6	7
1	3
6	7
1	3

# Check commented data-points are not in the data
query II
FROM read_csv('data/csv/comments/big.csv') where  a = 20
----

query I
SELECT count(*) FROM read_csv('data/csv/comments/big.csv')
----
1448

# Test empty spaces
query II
FROM read_csv('data/csv/comments/empty_space.csv', comment = '#', delim = ';');
----
1	3
1	3
1	#3
1	 #3


# Lets try with a buffer limit

loop buffer_size 30 35

query II
FROM read_csv('data/csv/comments/simple.csv', buffer_size = ${buffer_size}) limit 5;
----
1	3
6	7

endloop

## Character indicating that the remainder of line should not be parsed. If found at the beginning of a line, the line will be ignored altogether.
## This parameter must be a single character.
#
## Fully commented lines are ignored by the parameter header but not by skiprows.
#
