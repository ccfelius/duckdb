# name: test/sql/copy/csv/test_parallel_nullpadding.test
# description: Test NullPadding in parallel
# group: [csv]

query I
select count(*) from read_csv('data/csv/evil_nullpadding.csv', delim = ';', quote = '"', null_padding = True, header = 0)
----
3

# If we force the buffer to break in the middle of the quotes, we can't read this.
statement error
select count(*) from read_csv('data/csv/evil_nullpadding.csv', delim = ';', quote = '"', null_padding = True, header = 0, buffer_size = 26)
----
Value with unterminated quote found. The parallel scanner does not support null_padding in conjunction with quoted new lines. Please disable the parallel csv reader with parallel=false

statement error
select count(*) from read_csv('data/csv/evil_nullpadding.csv', delim = ';', quote = '"', null_padding = True, header = 0, buffer_size = 27)
----
Value with unterminated quote found. The parallel scanner does not support null_padding in conjunction with quoted new lines. Please disable the parallel csv reader with parallel=false

query I
select count(*) from read_csv('data/csv/evil_nullpadding.csv', delim = ';', quote = '"', null_padding = True, header = 0, buffer_size = 27, parallel = false)
----
3
