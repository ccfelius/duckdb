
query III
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/bad.csv', 
    columns = {'0': 'INTEGER', '1': 'INTEGER', '3': 'VARCHAR'}, 
    ignore_errors=true);
----
1	2	AAA
6	7	CCC


query IIIII
FROM read_csv_error_log()
----
2	1	BBB	Could not convert string 'BBB' to INT32	test/sql/copy/csv/data/error/mismatch/bad.csv

# Test with multiple files
query III
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/*.csv', 
    columns = {'0': 'INTEGER', '1': 'INTEGER', '3': 'VARCHAR'}, 
    ignore_errors=true);
----
1	2	AAA
6	7	CCC
1	2	DDD
4	5	9


query IIIII
FROM read_csv_error_log()
----
2	1	BBB	Could not convert string 'BBB' to INT32	test/sql/copy/csv/data/error/mismatch/bad.csv
4	0	EEE	Could not convert string 'EEE' to INT32	test/sql/copy/csv/data/error/mismatch/bad2.csv

# Set limit
statement ok
SET csv_error_log_size = 1;

query III
SELECT * FROM read_csv(
    'test/sql/copy/csv/data/error/mismatch/*.csv', 
    columns = {'0': 'INTEGER', '1': 'INTEGER', '3': 'VARCHAR'}, 
    ignore_errors=true);
----
1	2	AAA
6	7	CCC
1	2	DDD
4	5	9

# We should now have only one error logged
query IIIII
FROM read_csv_error_log()
----
2	1	BBB	Could not convert string 'BBB' to INT32	test/sql/copy/csv/data/error/mismatch/bad.csv