# name: test/sql/copy/parquet/encryption/arrow_compatibility.test
# description: Test Parquet encryption
# group: [encryption]

require parquet

# parquet keys are not persisted across restarts
require noforcestorage

statement ok
PRAGMA disable_verification

statement ok
PRAGMA add_parquet_key('arrow_key', '0123456789012345')

query I
SELECT flba_field FROM read_parquet('uniform_encryption.parquet.encrypted', encryption_config={footer_key: 'arrow_key'}) LIMIT 1;
----
\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00