# name: test/sql/copy/parquet/encryption/arrow_compatibility.test
# description: Test Parquet encryption
# group: [encryption]

## TODO: simple parquet format fallback FIX!
## if there is no AAD 8-byte prefix, it's DuckDB's own implementation
## And we will automagically default to that. If there is an 8-byte suffix.
## it is the Arrow-compatible implementation. We then default to that one (with the AAD shizzle)

require parquet

# parquet keys are not persisted across restarts
require noforcestorage

statement ok
PRAGMA disable_verification

statement ok
PRAGMA add_parquet_key('arrow_key', '0123456789012345')

query I
SELECT flba_field FROM read_parquet('uniform_encryption.parquet.encrypted', encryption_config={footer_key: 'arrow_key'}) LIMIT 1;
----
\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00