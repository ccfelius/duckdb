# name: test/sql/copy/file_size_bytes.test
# description: test FILE_SIZE_BYTES parameter for COPY
# group: [copy]

require parquet

statement ok
PRAGMA verify_parallelism;

statement ok
pragma threads=4;

statement ok
CREATE TABLE bigdata AS SELECT i AS col_a, i AS col_b FROM range(0,10000) tbl(i);

# parameter in bytes
statement ok
COPY (FROM bigdata) TO '__TEST_DIR__/file_size_bytes' (FORMAT PARQUET, FILE_SIZE_BYTES 1000);

query I
SELECT COUNT(*) FROM PARQUET_SCAN('__TEST_DIR__/file_size_bytes/*.parquet')
----
10000

# parameter in human-readable format
statement ok
COPY (FROM bigdata) TO '__TEST_DIR__/file_size_bytes' (FORMAT PARQUET, FILE_SIZE_BYTES '1kb', OVERWRITE_OR_IGNORE TRUE);

query I
SELECT COUNT(*) FROM PARQUET_SCAN('__TEST_DIR__/file_size_bytes/*.parquet')
----
10000
