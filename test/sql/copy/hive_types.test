# name: test/sql/copy/hive_types.test
# description: basic tests hive_types flag
# group: [copy]

require parquet

statement ok
PRAGMA enable_verification

#	create a table with multiple columns,   -   right now I'm using a localfile(!)  //lars
#	...

#	the old way, provides the expected output
query IIII
select * exclude(date,dist), date::Date date, dist::SMALLINT dist FROM read_parquet('../file.parquet', hive_partitioning=1);
----
0	30	2020-01-01	10
1	37	2020-01-01	10
2	29	2020-01-01	13
3	45	2020-01-01	14
4	51	2020-02-12	18
5	19	2020-02-12	18
6	25	2020-02-12	24

#	the new way
query IIII
FROM read_parquet('../file.parquet', hive_partitioning=1, hive_types={'date':'date', 'ref':'smallint'});
----
0	2020-01-01	10	30
1	2020-01-01	10	37
2	2020-01-01	13	29
3	2020-01-01	14	45
4	2020-02-12	18	51
5	2020-02-12	18	19
6	2020-02-12	24	25
