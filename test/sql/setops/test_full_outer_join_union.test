# name: test/sql/setops/test_full_outer_join_union.test
# description: Test full outer joins on unions
# group: [setops]

statement ok
PRAGMA disable_optimizer;

statement ok
CREATE TABLE integers(i INTEGER);

statement ok
INSERT INTO integers VALUES (1), (2);

statement ok
CREATE TABLE integers2(i INTEGER);

statement ok
INSERT INTO integers2 VALUES (2), (3);

statement ok
CREATE VIEW v1 AS SELECT * FROM integers UNION ALL SELECT * FROM integers;

statement ok
CREATE VIEW v2 AS SELECT * FROM integers2 UNION ALL SELECT * FROM integers2;

query I
SELECT COUNT(*) FROM v1 JOIN v2 USING (i);
----
4

query I
SELECT COUNT(*) FROM v1 LEFT JOIN v2 USING (i);
----
6

query I
SELECT COUNT(*) FROM v1 RIGHT JOIN v2 USING (i);
----
6

query I
SELECT COUNT(*) FROM v1 FULL OUTER JOIN v2 USING (i);
----
8

# self joins
query I
SELECT COUNT(*) FROM v1 JOIN v1 v2 USING (i);
----
8

query I
SELECT COUNT(*) FROM v1 FULL OUTER JOIN v1 v2 USING (i);
----
8
