# name: test/sql/window/test_rank_orderby.test
# description: Test argument ordering for RANK and PERCENT_RANK
# group: [window]

statement ok
PRAGMA enable_verification

query IIII
SELECT 
	i,
	(i * 29) % 11 AS outside,
	rank(ORDER BY (i // 2) DESC) OVER w,
	percent_rank(ORDER BY (i // 2) DESC) OVER w,
FROM range(10) tbl(i)
WINDOW w AS (
	ORDER BY (i * 29) % 11
)
ORDER BY 2
----
0	0	9	0.8888888888888888
8	1	1	0.0
5	2	5	0.4444444444444444
2	3	7	0.6666666666666666
7	5	3	0.2222222222222222
4	6	5	0.4444444444444444
1	7	9	0.8888888888888888
9	8	1	0.0
6	9	3	0.2222222222222222
3	10	7	0.6666666666666666
