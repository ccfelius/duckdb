# name: test/sql/upsert/upsert_explicit_index.test
# group: [upsert]

statement ok
pragma enable_verification;

statement ok
create table tbl (i integer, j integer);

statement ok
insert into tbl values (5,3), (3,2);

statement ok
create unique index my_index on tbl(i);

statement ok
insert into tbl values (5,2) on conflict (i) do update set j = 10;

query II
select * from tbl;
----
5	10
3	2

statement ok
drop table tbl cascade;

statement ok
create table tbl (i integer PRIMARY KEY, j integer);

statement ok
insert into tbl values (42, 21), (21, 42);

statement ok
create index my_index on tbl(j);

statement ok
INSERT INTO tbl VALUES (42, 20) ON CONFLICT DO UPDATE SET j = 30;

query III
SELECT i, j, rowid FROM tbl WHERE j = 30;
----
42	30	2

query III
SELECT i, j, rowid FROM tbl ORDER BY ALL;
----
21	42	1
42	30	2
