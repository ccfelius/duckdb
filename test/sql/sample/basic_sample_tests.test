# name: test/sql/sample/basic_sample_tests.test
# group: [sample]

query I
select count(*) from range(100000) using sample (10000);
----
10000

query I
select count(*) from range(100) using sample (10);
----
10

query I
select count(*) from range(205000) using sample (10000);
----
10000

statement ok
create table t1 as select range a from range(204800);

statement ok
select * from duckdb_table_sample('t1');

statement ok
create or replace table t1 as select range a from range(1000);

query II
select avg(a) > 200, avg(a) < 800 from duckdb_table_sample('t1');
----
true	true

statement ok
create or replace table t1 as select range a from range(204800);

query II
select avg(a) > 20480, avg(a) < (0.9*204800) from duckdb_table_sample('t1');
----
true	true

query I
select count(*) from t1 using sample (200000);
----
200000
