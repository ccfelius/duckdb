# name: test/sql/sample/test_sample_is_stored.test
# description: Test sampling of larger relations
# group: [sample]

require vector_size 2048

load __TEST_DIR__/test_samples.db

statement ok
PRAGMA enable_verification

statement ok
create table materialized_range as select * from range(204800);

statement ok
create or replace table integers_1 as (select (range + 5)::VARCHAR a, range b from materialized_range);

# sample exists after restart
restart

query I
select count(*) from duckdb_table_sample('integers_1');
----
2048
