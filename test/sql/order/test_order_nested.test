# name: test/sql/order/test_order_nest.test
# description: Test ORDER BY keyword (nested types)
# group: [order]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE test0 (i INT[])

statement ok
INSERT INTO test0 VALUES ([2]), ([1]), ([1, 2]), ([]), ([2, 2]), ([NULL]), (NULL), ([2, 3])

query T
SELECT * FROM test0 ORDER BY i
----
NULL
[]
[1]
[1, 2]
[2]
[2, 2]
[2, 3]
[NULL]

query T
SELECT * FROM test0 ORDER BY i DESC
----
NULL
[NULL]
[2, 3]
[2, 2]
[2]
[1, 2]
[1]
[]

statement ok
CREATE TABLE test1 (i VARCHAR[])

statement ok
INSERT INTO test1 VALUES (['2']), (['1']), (['1', '2']), ([]), (['2', '2']), ([NULL]), (NULL), (['2', '3'])

query T
SELECT * FROM test1 ORDER BY i
----
NULL
[]
[1]
[1, 2]
[2]
[2, 2]
[2, 3]
[NULL]

query T
SELECT * FROM test1 ORDER BY i DESC
----
NULL
[NULL]
[2, 3]
[2, 2]
[2]
[1, 2]
[1]
[]

statement ok
CREATE TABLE test2 (i INT[][])

statement ok
INSERT INTO test2 VALUES ([[2]]), ([[1]]), ([NULL, []]), ([[1], [2]]), ([]), ([[]]), ([[2], [2]]), ([NULL]), (NULL), ([[2], [3]])

query T
SELECT * FROM test2 ORDER BY i
----
NULL
[]
[[]]
[[1]]
[[1], [2]]
[[2]]
[[2], [2]]
[[2], [3]]
[NULL]
[NULL, []]

query T
SELECT * FROM test2 ORDER BY i DESC
----
NULL
[NULL, []]
[NULL]
[[2], [3]]
[[2], [2]]
[[2]]
[[1], [2]]
[[1]]
[[]]
[]

statement ok
CREATE TABLE test3 (s STRUCT(i INTEGER, j INTEGER));

statement ok
INSERT INTO test3 values ({'i': 2, 'j': NULL}), ({'i': 1, 'j': NULL}), ({'i': 2, 'j': 3}), ({'i': 1, 'j': 2}), ({'i': 2, 'j': 2}), ({'i': NULL, 'j': NULL}), (NULL), ({'i': 2, 'j': 3})

query T
SELECT * FROM test3 ORDER BY s
----
NULL
{'i': 1, 'j': 2}
{'i': 1, 'j': NULL}
{'i': 2, 'j': 2}
{'i': 2, 'j': 3}
{'i': 2, 'j': 3}
{'i': 2, 'j': NULL}
{'i': NULL, 'j': NULL}

query T
SELECT * FROM test3 ORDER BY s DESC
----
NULL
{'i': NULL, 'j': NULL}
{'i': 2, 'j': NULL}
{'i': 2, 'j': 3}
{'i': 2, 'j': 3}
{'i': 2, 'j': 2}
{'i': 1, 'j': NULL}
{'i': 1, 'j': 2}
