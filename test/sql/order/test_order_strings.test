# name: test/sql/order/test_order_strings.test
# description: Test ORDER BY keyword (variable size sorting/payload columns)
# group: [order]

statement ok
PRAGMA threads=1

statement ok
CREATE TABLE test1 (s VARCHAR)

# strings longer than the initial 8 character prefix
statement ok
INSERT INTO test1 VALUES ('2'), ('355555552'), ('1'), ('10'), ('355555553'), ('355555551'), (NULL)

query I
SELECT * FROM test1 ORDER BY s
----
NULL
1
10
2
355555551
355555552
355555553

# sort on 10000 strings
statement ok
CREATE TABLE test2 AS (SELECT CAST(range AS VARCHAR) r, random() rand FROM range(10000))

statement ok
CREATE TABLE test2_1 AS (SELECT * FROM test2 ORDER BY r)

query T
SELECT count(*) FROM test2_1
----
10000

# string payload
statement ok
CREATE TABLE test3 AS (SELECT CAST(range AS VARCHAR) r, random() rand FROM range(10000))

statement ok
CREATE TABLE test3_1 AS (SELECT * FROM test3 ORDER BY rand)

query T
SELECT count(*) FROM test3_1
----
10000

# multiple columns
statement ok
CREATE TABLE test4 (i INT, j INT)

statement ok
INSERT INTO test4 VALUES (3, 3), (2, 3), (2, 2), (3, 2)

query II
SELECT * FROM test4 ORDER BY cast(i AS VARCHAR), j
----
2	2
2	3
3	2
3	3

query II
SELECT * FROM test4 ORDER BY i, cast(j AS VARCHAR)
----
2	2
2	3
3	2
3	3

query II
SELECT * FROM test4 ORDER BY cast(i AS VARCHAR), cast(j AS VARCHAR)
----
2	2
2	3
3	2
3	3

# TODO: sort with nested list payload, and with multiple var-size sort columns and NULLS