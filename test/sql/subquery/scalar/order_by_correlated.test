# name: test/sql/subquery/scalar/order_by_correlated.test
# description: Test ORDER BY in correlated subqueries
# group: [scalar]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE integers(i INTEGER);

statement ok
INSERT INTO integers VALUES (1), (2), (3), (NULL);

query II
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i ASC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i
----
NULL	NULL
1	2
2	3
3	NULL

query II
SELECT i, (
	SELECT * FROM integers WHERE i>i1.i ORDER BY i DESC NULLS FIRST LIMIT 1
) top
FROM integers i1
ORDER BY i
----
NULL	NULL
1	3
2	3
3	NULL
