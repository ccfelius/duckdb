# name: test/sql/json/issues/issue12188.test
# description: Test issue 12188 - Issue with Parsing NDJSON File in DuckDB: Unexpected Quotation Marks
# group: [issues]

require parquet

# We'd love to test that this gives an error, and it does if the JSON extension is not loaded
# However, in a few of our CI runs, the JSON extension is compiled in, and this unexpectedly succeeds
# So, we skip for now
mode skip

statement error
SELECT typeof(field1), typeof(field2) FROM 'data/parquet-testing/parquet_with_json.parquet' LIMIT 1
----
Catalog Error

mode unskip

require json

query II
SELECT typeof(field1), typeof(field2) FROM 'data/parquet-testing/parquet_with_json.parquet' LIMIT 1
----
JSON	JSON

statement ok
COPY (SELECT * FROM read_ndjson('data/json/12188.ndjson', maximum_depth=1)) TO '__TEST_DIR__/my.parquet';

query II
SELECT typeof(field1), typeof(field2) FROM '__TEST_DIR__/my.parquet' LIMIT 1
----
JSON	JSON
