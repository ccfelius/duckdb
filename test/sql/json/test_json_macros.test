# name: test/sql/json/test_json_macros.test
# description: Test JSON default macro's
# group: [json]

require json

statement ok
pragma enable_verification

statement ok
create table test as select range + 10 n, range v from range(10)

query T
select json_group_array(v) from test
----
[0,1,2,3,4,5,6,7,8,9]

query T
select json_group_object(n, v) from test
----
{"10":0,"11":1,"12":2,"13":3,"14":4,"15":5,"16":6,"17":7,"18":8,"19":9}

query T
select json_group_object(n, v) from test group by n % 2
----
{"10":0,"12":2,"14":4,"16":6,"18":8}
{"11":1,"13":3,"15":5,"17":7,"19":9}

statement ok
insert into test values (NULL, NULL), (20, NULL), (21, NULL), (NULL, 10), (NULL, 11)

query T
select json_group_object(n, v) from test group by n % 2
----
{"10":0,"12":2,"14":4,"16":6,"18":8,"20":null}
{"11":1,"13":3,"15":5,"17":7,"19":9,"21":null}
{}

query T
select json(' { "this" : "is", "a": [ "test" ] }')
----
{"this":"is","a":["test"]}
