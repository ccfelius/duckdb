# name: test/sql/types/bit/test_bit.test
# description: BIT tests
# group: [bit]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE bits (b bit);

# insert valid bit strings
statement ok
INSERT INTO bits VALUES('101011010'), ('111'), ('1010010101111111001101')

query I
SELECT * FROM bits
----
0000000101011010
00000111
001010010101111111001101

statement ok
INSERT INTO bits VALUES('0'), ('1'), ('0000000000000000000111')

query I
SELECT * FROM bits
----
0000000101011010
00000111
001010010101111111001101
00000000
00000001
000000000000000000000111

# query I
# SELECT * FROM bits WHERE b = '111';
# ----
# 001010010101111111001101
# 00000001

# insert invalid bit strings
statement error
INSERT INTO bits VALUES('101211010')
----
Conversion Error: Invalid character encountered in string -> bit conversion: '2'

statement error
INSERT INTO bits VALUES('1A10')
----
Conversion Error: Invalid character encountered in string -> bit conversion: 'A'

# bit null test and empty values
query I
SELECT NULL::BIT
----
NULL

statement ok
DELETE FROM bits

statement ok
INSERT INTO bits VALUES(''), (NULL)

query I
SELECT * FROM bits
----
(empty)
NULL


# try cast
query I
SELECT TRY_CAST('101' AS BIT)
----
00000101

query I
SELECT TRY_CAST('102' AS BIT)
----
NULL

# cast varchar column to bit type
statement ok
CREATE TABLE varchars (col VARCHAR);

statement ok
INSERT INTO varchars VALUES('1010010101010101100001111111001101'), ('0')

query I
SELECT col::BIT FROM varchars
----
0000001010010101010101100001111111001101
00000000

statement ok
INSERT INTO varchars VALUES('1011010'), ('0ðŸ¦†1'), ('1'), ('3')

query I
SELECT TRY_CAST(col AS BIT) FROM varchars
----
0000001010010101010101100001111111001101
00000000
01011010
NULL
00000001
NULL
