# name: test/sql/types/map/test_map.test
# description: Test basic functionality of maps
# group: [map]

statement ok
PRAGMA enable_verification

query I
select MAP(LIST_VALUE(1, 2, 3, 4),LIST_VALUE(10, 9, 8, 7))
----
{1=10, 2=9, 3=8, 4=7}

query I
select map_extract(m,1) from (select MAP(LIST_VALUE(1, 2, 3, 4),LIST_VALUE(10, 9, 8, 7)) as m) as T
----
[10]

query I
select map_extract(m,3) from (select MAP(LIST_VALUE(1, 2, 3, 4),LIST_VALUE(10, 9, 8, 7)) as m) as T
----
[8]

# Empty maps
query I
select MAP(LIST_VALUE(),LIST_VALUE())
----
{}

query I
select MAP()
----
{}

# Lists with different size are FORBIDDEN
statement error
select MAP(LIST_VALUE(10),LIST_VALUE())

# Maps that are not initilalized empty or with lists are  FORBIDDEN
statement error
select MAP(10,12)