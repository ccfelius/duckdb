# name: test/sql/types/map/test_map_cardinality.test
# description: Test cardinality function for maps
# group: [map]

statement error
select cardinality(NULL)

query I
select CARDINALITY(MAP(LIST_VALUE(1, 2, 3, 4),LIST_VALUE(10, 9, 8, 7)))
----
4

query I
select CARDINALITY(MAP(LIST_VALUE(),LIST_VALUE()))
----
0

query I
select CARDINALITY(MAP())
----
0

#What about multiple rows?
statement ok
create table ints (a integer, b integer)

statement ok
insert into ints values (1,1),(1,2),(1,3),(2,2),(2,3),(3,3),(4,4)

query II
select a, cardinality(m) from (select a,MAP(lsta,lstb) as m from (SELECT list(a) as lsta, list(b) as lstb, a FROM ints group by a) as lst_tbl) as T
----
1	3
2	2
3	1
4	1


#What about selection vectors?
query II
select a, cardinality(m) from (select a,MAP(lsta,lstb) as m from (SELECT list(a) as lsta, list(b) as lstb, a FROM ints where b < 3 group by a) as lst_tbl) as T
----
1	2
2	1