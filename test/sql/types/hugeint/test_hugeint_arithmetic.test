# name: test/sql/types/hugeint/test_hugeint_arithmetic.test
# description: Test arithmetic with huge integers
# group: [hugeint]

# negation
query II
SELECT -(100::HUGEINT), -(-(50::HUGEINT));
----
-100	50

# negate 0
query I
SELECT -(0::HUGEINT)
----
0

# negation with large numbers
query II
SELECT -(100000000000000000000::HUGEINT), -(-(100000000000000000000::HUGEINT));
----
-100000000000000000000	100000000000000000000

# addition
# simple addition: small values
query I
SELECT 42::HUGEINT + 42::HUGEINT;
----
84

# negative values
query III
SELECT 42::HUGEINT + -42::HUGEINT, -42::HUGEINT + 100::HUGEINT, -42::HUGEINT+-42::HUGEINT;
----
0	58	-84

# large values
query I
SELECT '100000000000000000000'::HUGEINT + '100000000000000000000'::HUGEINT;
----
200000000000000000000

# large negative values
query I
SELECT '100000000000000000000'::HUGEINT + '-1000000000000000000000'::HUGEINT;
----
-900000000000000000000

query I
SELECT '5'::HUGEINT + '-10000000000000000002'::HUGEINT;
----
-9999999999999999997

# overflow in addition
statement error
SELECT '170141183460469231731687303715884105727'::HUGEINT + '170141183460469231731687303715884105727'::HUGEINT;

statement error
SELECT '170141183460469231731687303715884105727'::HUGEINT + '10'::HUGEINT;

# subtraction
query II
SELECT 100::HUGEINT - 42::HUGEINT, 3::HUGEINT - 5::HUGEINT;
----
58	-2

# negative combinations
query III
SELECT -100::HUGEINT - 42::HUGEINT, -3::HUGEINT - 5::HUGEINT, 12::HUGEINT-(-12::HUGEINT);
----
-142	-8	24

# large subtraction
query I
SELECT '-10000000000000000002'::HUGEINT - '-10000000000000000002'::HUGEINT;
----
0

# underflow in subtraction
statement error
SELECT '-170141183460469231731687303715884105727'::HUGEINT - '170141183460469231731687303715884105727'::HUGEINT;

statement error
SELECT '170141183460469231731687303715884105727'::HUGEINT - '-170141183460469231731687303715884105727'::HUGEINT;

# multiplication
query I
SELECT 100::HUGEINT * 50::HUGEINT;
----
5000
