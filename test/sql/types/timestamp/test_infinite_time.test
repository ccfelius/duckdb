# name: test/sql/types/timestamp/test_infinite_time.test
# description: Extract timestamp function
# group: [timestamp]

statement ok
PRAGMA enable_verification

#
# Special date and time values from
# https://www.postgresql.org/docs/14/datatype-datetime.html#DATATYPE-DATETIME-SPECIAL-TABLE
#

# Case insensitivity
foreach datatype TIMESTAMP TIMESTAMPTZ DATE

foreach str infinity Infinity INFINITY inFinIty

# PG displays numeric infinities in Titlecase but temporal infinities in lowercase
query II
SELECT '${str}'::${datatype}, '-${str}'::${datatype};
----
infinity	-infinity

endloop

endloop

# Table insertion
statement ok
CREATE TABLE specials (ts TIMESTAMP, tstz TIMESTAMPTZ, dt DATE);

statement ok
INSERT INTO specials VALUES
	('infinity'::TIMESTAMP, 'infinity'::TIMESTAMPTZ, 'infinity'::DATE),
	('-infinity'::TIMESTAMP, '-infinity'::TIMESTAMPTZ, '-infinity'::DATE),
	('epoch'::TIMESTAMP, 'epoch'::TIMESTAMPTZ, 'epoch'::DATE),
;

query III
SELECT * FROM specials;
----
infinity	infinity	infinity
-infinity	-infinity	-infinity
1970-01-01 00:00:00	1970-01-01 00:00:00+00	1970-01-01
