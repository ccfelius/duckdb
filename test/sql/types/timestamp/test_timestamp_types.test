# name: test/sql/types/timestamp/test_timestamp_types.test
# description: Test TIMESTAMP types
# group: [timestamp]

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE IF NOT EXISTS timestamp (sec TIMESTAMP_S, milli TIMESTAMP_MS,micro TIMESTAMP_US, nano TIMESTAMP_NS );

statement ok
INSERT INTO timestamp VALUES ('2008-01-01 00:00:01','2008-01-01 00:00:01.594','2008-01-01 00:00:01.88926','2008-01-01 00:00:01.889268321' )

#FIXME: The timestamp->string string->timestamp functions go only up to microsec right now
query TTTT
SELECT * from timestamp;
----
2008-01-01 00:00:01	2008-01-01 00:00:01.594	2008-01-01 00:00:01.88926	2008-01-01 00:00:01.889268

# Apply Year Function
query TTT
SELECT YEAR(sec),YEAR(milli),YEAR(nano) from timestamp;
----
2008	2008	2008

# Do some conversions
query TTT
SELECT nano::TIMESTAMP, milli::TIMESTAMP,sec::TIMESTAMP from timestamp;
----
2008-01-01 00:00:01.889268	2008-01-01 00:00:01.594	2008-01-01 00:00:01

query TTT
SELECT micro::TIMESTAMP_S, micro::TIMESTAMP_MS,micro::TIMESTAMP_NS from timestamp;
----
2008-01-01 00:00:01	2008-01-01 00:00:01.889	2008-01-01 00:00:01.88926


statement ok
INSERT INTO timestamp VALUES ('2008-01-01 00:00:51','2008-01-01 00:00:01.894','2008-01-01 00:00:01.99926','2008-01-01 00:00:01.999268321' )

statement ok
INSERT INTO timestamp VALUES ('2008-01-01 00:00:11','2008-01-01 00:00:01.794','2008-01-01 00:00:01.98926','2008-01-01 00:00:01.899268321' )

# Test Order BY
query T
select sec from timestamp order by sec;
----
2008-01-01 00:00:01
2008-01-01 00:00:11
2008-01-01 00:00:51

query T
select milli from timestamp order by milli;
----
2008-01-01 00:00:01.594
2008-01-01 00:00:01.794
2008-01-01 00:00:01.894

query T
select nano from timestamp order by nano;
----
2008-01-01 00:00:01.889268
2008-01-01 00:00:01.899268
2008-01-01 00:00:01.999268

# Overflow from US to NS
statement error
select '90000-01-19 03:14:07.999999'::TIMESTAMP_US::TIMESTAMP_NS

#DATE/TIME conversions are not directly supported yet
statement error
select sec::DATE from timestamp;

statement error
select milli::DATE from timestamp;

statement error
select nano::DATE from timestamp;

statement error
select sec::TIME from timestamp;

statement error
select milli::TIME from timestamp;

statement error
select nano::TIME from timestamp;

# Some timestamp direct conversions are not yet supported
statement error
select sec::TIMESTAMP_MS from timestamp;

statement error
select sec::TIMESTAMP_NS from timestamp;


statement error
select milli::TIMESTAMP_SEC from timestamp;


statement error
select milli::TIMESTAMP_NS from timestamp;


statement error
select nano::TIMESTAMP_SEC from timestamp;

statement error
select nano::TIMESTAMP_MS from timestamp;