# name: test/sql/types/union/union_cast.test
# description: Test union to union casts
# group: [union_type]

statement ok
create table tbl1(u UNION(i32 INT, str VARCHAR));

statement ok
insert into tbl1 values (1) , ('two') , ('three')

query I
SELECT * FROM tbl1;
----
1
two
three

statement ok
create table tbl2(u UNION(str VARCHAR, i32 INT, f32 FLOAT));

statement ok
insert into tbl2 values ('five'), (4), (6.0);

query I
SELECT * FROM tbl2;
----
five
4
6.0

query III
SELECT u.i32, u.str, u.f32 FROM tbl2;
----
NULL	five	NULL
4		NULL	NULL
NULL	NULL	6.0

query I
SELECT * FROM tbl2 UNION SELECT * FROM tbl1;
----
five
4
6.0
1
two
three

query I
SELECT * FROM tbl1 UNION SELECT * FROM tbl2;
----
1
two
three
five
4
6.0

query III
SELECT u.i32, u.str, u.f32 FROM tbl2 UNION SELECT u.i32, u.str, NULL FROM tbl1;
----
NULL	five	NULL
4		NULL	NULL
NULL	NULL	6.0
1		NULL	NULL
NULL	two		NULL
NULL	three	NULL
