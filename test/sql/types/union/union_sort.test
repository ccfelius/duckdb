# name: test/sql/types/union/union_sort.test
# description: Test sorting of union types
# group: [union_type]

statement ok
CREATE TABLE tbl (a UNION(a INT, b INT));

statement ok
INSERT INTO tbl VALUES (union_value(b := 1)), (union_value(a := 4)), (union_value(a := 1)), (union_value(b := 2)), (union_value(a := 3)), (NULL);

# unions sort first by tag, then by value
query II
SELECT union_tag(a), a FROM tbl ORDER BY a ASC;
----
NULL	NULL
a	1
a	3
a	4
b	1
b	2


query II
SELECT union_tag(a), a FROM tbl ORDER BY a DESC;
----
NULL	NULL
b	2
b	1
a	4
a	3
a	1



# todo also test nested unions
#statement ok
#CREATE TABLE tbl2 (a UNION(k INT, b UNION(k INT, v INT)));

#statement ok
#INSERT INTO tbl2 VALUES ({'k': 1})

#query II
#SELECT union_tag(a), union_tag(a.b) FROM tbl2 ORDER BY a ASC;
#----
#a	NULL
#a	NULL
#a	NULL
#b	b
#b	a
