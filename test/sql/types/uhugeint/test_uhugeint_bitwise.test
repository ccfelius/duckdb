# name: test/sql/types/uhugeint/test_uhugeint_bitwise.test
# description: Test bitwise operations of unsigned huge int type
# group: [uhugeint]

statement ok
PRAGMA enable_verification

# left-shift
query I
SELECT 1::UHUGEINT << 3
----
8

query I
SELECT 27::UHUGEINT << 0
----
27

# large shifts
query II
select 1::UHUGEINT << 50, 1::UHUGEINT << 100;
----
1125899906842624	1267650600228229401496703205376

# shift chains
query II
select (((((1::UHUGEINT << 50) << 50) << 2) << 3) << 8), (1::UHUGEINT)<<50<<20<<7<<18<<3<<6<<9
----
10384593717069655257060992658440192	10384593717069655257060992658440192

query I
select 1::UHUGEINT << 64;
----
18446744073709551616


# out of bounds shifts
statement error
select 1::UHUGEINT << 200

statement error
SELECT '1329227995784915872903807060280344576'::UHUGEINT << 50;

statement error
SELECT 27::UHUGEINT << -1

statement error
SELECT 100::UHUGEINT << '1329227995784915872903807060280344576'::UHUGEINT

# right-shift
query I
SELECT 8::UHUGEINT >> 3
----
1

query I
SELECT 27::UHUGEINT >> 0
----
27

statement error
SELECT 27::UHUGEINT >> -1

# large shifts
query II
select (1::UHUGEINT << 100) >> 50, (1::UHUGEINT << 120)>>108;
----
1125899906842624	4096

query I
SELECT '1329227995784915872903807060280344576'::UHUGEINT >> 200
----
0

query I
select -11367237885269962203896920952509169001 >> 200;
----
0

query I
SELECT '1329227995784915872903807060280344576'::UHUGEINT >> 64
----
72057594037927936

query I
SELECT '1329227995784915872903807060280344576'::UHUGEINT >> 96
----
16777216

query I
SELECT '1329227995784915872903807060280344576'::UHUGEINT >> 4 >> 5 >> 7 >> 9 >> 12 >> 13
----
1180591620717411303424

# bitwise &
query I
select 1::UHUGEINT & 3::UHUGEINT
----
1

query I
select 51290852742897895128414::UHUGEINT & 4923847238975289723895239078235::UHUGEINT
----
40291148384447586808154

# bitwise |
query I
select 1::UHUGEINT | 2::UHUGEINT
----
3

query I
select 51290852742897895128414::UHUGEINT | 4923847238975289723895239078235::UHUGEINT
----
4923847249974994082345547398495

# bitwise xor
query I
select xor(1::UHUGEINT, 3::UHUGEINT)
----
2

query I
select xor(51290852742897895128414::UHUGEINT, 4923847238975289723895239078235::UHUGEINT)
----
4923847209683845697897960590341

# bitwise not
query I
select ~(1::UHUGEINT)
----
340282366920938463463374607431768211454

# big shifts
query I
select 1::UHUGEINT >> 1000;
----
0

query I
select 1 >> 170141183460469231731687303715884105727::UHUGEINT;
----
0

statement error
select 1::UHUGEINT << 1000;

statement error
select 1 << 170141183460469231731687303715884105727::UHUGEINT;
