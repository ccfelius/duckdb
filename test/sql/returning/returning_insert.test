# name: test/sql/returning/returning_insert.test
# description: Test returning with top level INSERT statement
# group: [returning]

statement ok
CREATE TABLE table1 (a INTEGER DEFAULT -1, b INTEGER DEFAULT -2, c INTEGER DEFAULT -3);

# returning 1 column
query I
INSERT INTO table1 VALUES (1, 2, 3) RETURNING a;
----
1

# returning all columns with *
query I
INSERT INTO table1 VALUES (1, 2, 3) RETURNING *;
----
1	2	3

# returning all columns with column names
query I
INSERT INTO table1 VALUES (1, 2, 3) RETURNING a, b, c;
----
1	2	3


# returning column names out of order
query I
INSERT INTO table1 VALUES (1, 2, 3) RETURNING c, a, b;
----
1	2	3


# returning using a column alias
query I
INSERT INTO table1 VALUES (1, 2, 3) RETURNING a AS aliascol;
----
100

# returning using a column alias
query I
INSERT INTO table1 VALUES (1, 2, 3) RETURNING a AS aliascol;
----
100

# returning the result of inserting multiple columns
query I
INSERT INTO table1 VALUES (1, 2, 3), (4, 5, 6), (7, 8, 9) RETURNING *;
----
1   2   3
4   5   6
7   8   9

# returning expression with function
query I
INSERT INTO table1 VALUES (1, 1, 1), (2, 2, 2), (3, 3, 3) RETURNING SUM(a);
----
6

# returning * while inserting only a subset of columns
query I
INSERT INTO table1(a) VALUES (10) RETURNING *;
----
10	-2	-3


query I
INSERT INTO table1 (SELECT * from table1 WHERE a = 3, b = 3, c=3) returning *;
----
3	3	3

# returing
