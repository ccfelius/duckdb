# name: test/sql/returning/returning_basic.test
# description: Test returning and
# group: [returning]

statement ok
CREATE TABLE table1 (a INTEGER DEFAULT 0, b INTEGER DEFAULT 1, c INTEGER);


# returning only subset of inserted columns
query II
INSERT INTO table1 (a, b, c) VALUES (1, 2, 3) RETURNING a, c;
----
1	3

# returning only subset of inserted columns
query II
INSERT INTO table1 (a, b, c) VALUES (1, 2, 3) RETURNING c, a;
----
3	1


# no returning statement
query I
INSERT INTO table1 VALUES (10, 20, 30);
----
1

# returning with two of the same expression
query III
INSERT INTO table1 VALUES (10, 20, 30), (40, 50, 60), (70, 80, 90) RETURNING a, b, b;
----
10	20	20
40	50	50
70	80	80


# returning * expressions
query III
INSERT INTO table1 VALUES (10, 20, 30), (40, 50, 60), (70, 80, 90) RETURNING *;
----
10	20	30
40	50	60
70	80	90

# returning with boolean expressions
query III
INSERT INTO table1 VALUES (10, 20, 30), (40, 50, 60), (70, 80, 90) RETURNING c, b, a NOT IN (10);
----
30	20	0
60	50	1
90	80	1

# returning literals
query I
INSERT INTO table1 VALUES (10, 20, 30) RETURNING 100;
----
100

statement ok
INSERT INTO table1 VALUES (3, 3, 3);

query III
INSERT INTO table1 SELECT * from table1 WHERE a = 3 AND b = 3 AND c=3 returning *;
----
3	3	3


statement ok
CREATE TABLE t2(a INT, b VARCHAR(10));


query I
INSERT INTO t2 VALUES (10, 'duck db') RETURNING b;
----
duck db
