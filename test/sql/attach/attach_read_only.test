# name: test/sql/attach/attach_read_only.test
# description: Test attaching of a read-only database
# group: [attach]

statement ok
PRAGMA enable_verification

statement error
ATTACH ':memory:' AS db1 (READONLY 1)
----
Cannot launch in-memory database in read-only mode

statement error
ATTACH ':memory:' AS db1 (BLABLABLA 1)
----
Unrecognized option

statement error
ATTACH '__TEST_DIR__/attach_read_only.db' AS db1 (READONLY 1)
----
database does not exist

# create a database file and close it again
statement ok
ATTACH '__TEST_DIR__/attach_read_only.db' AS db1

statement ok
CREATE TABLE db1.integers AS SELECT * FROM range(10) t(i);

statement ok
DETACH db1

# now attach in read only mode
statement ok
ATTACH '__TEST_DIR__/attach_read_only.db' AS db1 (READONLY 1)

query I
SELECT SUM(i) FROM db1.integers
----
45

# database is opened in read-only mode - cannot create a table
statement error
CREATE TABLE db1.test AS SELECT * FROM range(10) t(i);
