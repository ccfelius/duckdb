# name: test/sql/secrets/create_secret_r2.test
# description: Test secret creation using the default s3 secret provider
# group: [sample]

#statement ok
#PRAGMA enable_verification;

require httpfs

# GCS Secrets automatically default to the correct endpoint for Google Cloud Storage
statement ok
CREATE SECRET gcs_secret
TYPE GCS
WITH (
    KEY_ID 'my_key',
    SECRET 'my_secret'
)

# The secret will be created for the default scope
query III
SELECT name, type, scope FROM duckdb_credentials() WHERE name='gcs_secret';
----
gcs_secret	gcs	[s3://]

statement error
FROM 's3://test-bucket/test.csv'
----
https://storage.googleapis.com/test-bucket/test.csv
