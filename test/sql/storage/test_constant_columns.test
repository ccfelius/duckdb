# name: test/sql/storage/test_constant_columns.test
# description: Test storage of constant columns (columns that all have the same value)
# group: [storage]

# load the DB from disk
load __TEST_DIR__/constant_columns.db

# simple constant
statement ok
CREATE TABLE integers AS SELECT 1 i FROM range(1000000)

query IIIII
SELECT MIN(i), MAX(i), AVG(i), COUNT(*), COUNT(i) FROM integers
----
1	1	1	1000000	1000000

restart

query IIIII
SELECT MIN(i), MAX(i), AVG(i), COUNT(*), COUNT(i) FROM integers
----
1	1	1	1000000	1000000

# constant null
statement ok
CREATE TABLE nulls AS SELECT NULL i FROM range(1000000)

query IIIII
SELECT MIN(i), MAX(i), AVG(i), COUNT(*), COUNT(i) FROM nulls
----
NULL	NULL	NULL	1000000	0
