# name: test/sql/storage/compact_block_size/compression_functions.test
# description: Test copying between databases with different block sizes.
# group: [compact_block_size]

require skip_reload

require noforcestorage

statement ok
SET threads=1;

statement ok
PRAGMA wal_autocheckpoint='1TB';

statement ok
ATTACH '__TEST_DIR__/small.db' (BLOCK_SIZE 16384);

statement ok
CREATE TABLE small.tbl AS SELECT range AS i FROM range(10000);

statement ok
ATTACH '__TEST_DIR__/large.db' (BLOCK_SIZE 262144);

statement ok
CREATE TABLE large.tbl AS SELECT range AS i FROM range(10000);

statement ok
CHECKPOINT large;

statement ok
CHECKPOINT small;

query I
SELECT COUNT(*) FROM pragma_storage_info('small.tbl') WHERE compression = 'BitPacking';
----
0