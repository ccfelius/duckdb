# name: test/sql/storage/compression/bitpacking/bitpacking_types.test
# description: Test bitpacking with unsigned type and negative values
# group: [bitpacking]

# load the DB from disk
load __TEST_DIR__/test_bitpacking.db

statement ok
PRAGMA force_compression = 'bitpacking'

foreach type int16

statement ok
CREATE TABLE test_${type}_table (a ${type});

statement ok
INSERT INTO test_${type}_table SELECT i FROM range(-128, 128) tbl(i);

statement ok
checkpoint

query IIII
SELECT AVG(a), MIN(a), MAX(a), COUNT(*) FROM test_${type}_table
----
-0.500000	-128	127	256

endloop

foreach type uint8 uint16 uint32 uint64

statement ok
CREATE TABLE test_${type}_table (a ${type});

statement ok
INSERT INTO test_${type}_table SELECT i FROM range(0, 256) tbl(i);

statement ok
checkpoint

query IIII
SELECT AVG(a), MIN(a), MAX(a), COUNT(*) FROM test_${type}_table
----
127.500000	0	255	256

endloop

