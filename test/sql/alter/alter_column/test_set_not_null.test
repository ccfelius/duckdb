# name: test/sql/alter/not_null/test_set_not_null.test
# description: Test ALTER TABLE ALTER COLUMN column_name SET NOT NULL
# group: [alter_column]
# Happy path

statement ok
PRAGMA enable_verification

statement ok
CREATE TABLE test(i INTEGER, j INTEGER)

statement ok
INSERT INTO test VALUES (1, 1), (2, 2)

statement ok
ALTER TABLE test ALTER COLUMN j SET NOT NULL

statement error 
INSERT INTO test VALUES (3, NULL)
# SET again
statement ok
ALTER TABLE test ALTER COLUMN j SET NOT NULL

statement error 
INSERT INTO test VALUES (3, NULL)

query II
SELECT * FROM test
----
1	1
2	2

# SET NOT NULL failed if contains null value
statement ok
CREATE TABLE test2(i INTEGER, j INTEGER)

statement ok
INSERT INTO test2 VALUES (1, 1), (2, 2), (3, null)

statement error
ALTER TABLE test2 ALTER COLUMN j SET NOT NULL

statement ok
INSERT INTO test2 VALUES (4, null)

query II
SELECT * FROM test2
----
1	1
2	2
3	NULL
4	NULL
