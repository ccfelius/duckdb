# name: test/sql/select/test_select_alias_prefix_colon.test
# description: Test selecting a view through a qualified reference
# group: [select]

statement ok
PRAGMA enable_verification

query I
SELECT j : 42;
----
42

query I
select column_name from (describe SELECT j : 42)
----
j

query I
SELECT "j" : 42;
----
42

statement error
SELECT 'j': 42
----
Parser Error

query I
SELECT "hel lo" : 42;
----
42

query I
select column_name from (describe SELECT "hel lo" : 42)
----
hel lo

query III
SELECT j1 : 42, 42 AS j2, 42 j3;
----
42	42	42

statement ok
CREATE TABLE a (i INTEGER);

statement ok
INSERT INTO a VALUES (42);

query I
SELECT j : i FROM a
----
42

query I
SELECT "j" : "i" FROM a
----
42

query I
SELECT * FROM b : a
----
42

query I
SELECT * FROM "b" : a
----
42

query I
SELECT i FROM b : a
----
42

query I
SELECT b.i FROM b : a
----
42

statement error
SELECT a.i FROM b : a
----
Binder Error: Referenced table "a" not found!
Candidate tables: "b"

statement error
SELECT a : 42 AS b
----
syntax error

query I
from my_wonderful_values : (values(42))
----
42

query I
from 'my_wonderful_values' : (values(42))
----
42

query I
from "my_wonderful_values" : (values(42))
----
42

query II
from my_wonderful_values(wonderful_value_one, wonderful_value_two) : (values(42, 43))
----
42	43

query I
select column_name from (describe from my_wonderful_values(wonderful_value_one, wonderful_value_two) : (values(42, 43)))
----
wonderful_value_one
wonderful_value_two

query II
from "my_wonderful_values"("wonderful_value_one", "wonderful_value_two") : (values(42, 43))
----
42	43

# single quotes don't work for the table values alias because bison
statement error
from 'my_wonderful_values'(wonderful_value_one, wonderful_value_two) : (values(42, 43))
----
Parser Error

# but they *do* work for the columns
query II
from "my_wonderful_values"('wonderful_value_one', 'wonderful_value_two') : (values(42, 43))
----
42	43

query I
select column_name from (describe from my_wonderful_values(wonderful_value_one, wonderful_value_two) : (select 42, 43))
----
wonderful_value_one
wonderful_value_two

# joins

query II
from a(i) : (values(42)) join
     b(j) : (values(42))
     on a.i = b.j;
----
42	42

query II
from "a"("i") : (values(42)) join
     "b"("j") : (values(42))
     on a.i = b.j;
----
42	42

# again, single quotes don't work for the table values alias because bison
statement error
from 'a'('i') : (values(42)) join
     'b'('j') : (values(42))
     on a.i = b.j;
----
Parser Error

query II
from "a"('i') : (values(42)) join
     "b"('j') : (values(42))
     on a.i = b.j;
----
42	42


