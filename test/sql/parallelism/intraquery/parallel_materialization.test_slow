# name: test/sql/parallelism/intraquery/parallel_materialization.test_slow
# description: Test parallel materialization of results
# group: [intraquery]

statement ok
PRAGMA enable_verification

statement ok
PRAGMA threads=4

statement ok
PRAGMA verify_parallelism

statement ok
CREATE TABLE integers AS SELECT * FROM range(5000000) tbl(i);

statement ok
CREATE TABLE other_table AS SELECT 337 i UNION ALL SELECT 948247 UNION ALL SELECT 1779793;

query I
SELECT * FROM integers WHERE i IN (SELECT * FROM other_table)
----
337
948247
1779793